!function(t,a,e){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(a||e)}(function(t){"use strict";var a=function(a,e,n){var s={invalid:[],getCaret:function(){try{var t,e=0,n=a.get(0),r=document.selection,o=n.selectionStart;return r&&navigator.appVersion.indexOf("MSIE 10")===-1?(t=r.createRange(),t.moveStart("character",-s.val().length),e=t.text.length):(o||"0"===o)&&(e=o),e}catch(i){}},setCaret:function(t){try{if(a.is(":focus")){var e,n=a.get(0);n.setSelectionRange?n.setSelectionRange(t,t):(e=n.createTextRange(),e.collapse(!0),e.moveEnd("character",t),e.moveStart("character",t),e.select())}}catch(s){}},events:function(){a.on("keydown.mask",function(t){a.data("mask-keycode",t.keyCode||t.which),a.data("mask-previus-value",a.val()),a.data("mask-previus-caret-pos",s.getCaret()),s.maskDigitPosMapOld=s.maskDigitPosMap}).on(t.jMaskGlobals.useInput?"input.mask":"keyup.mask",s.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){a.keydown().keyup()},100)}).on("change.mask",function(){a.data("changed",!0)}).on("blur.mask",function(){i===s.val()||a.data("changed")||a.trigger("change"),a.data("changed",!1)}).on("blur.mask",function(){i=s.val()}).on("focus.mask",function(a){n.selectOnFocus===!0&&t(a.target).select()}).on("focusout.mask",function(){n.clearIfNotMatch&&!r.test(s.val())&&s.val("")})},getRegexMask:function(){for(var t,a,n,s,r,i,l=[],c=0;c<e.length;c++)t=o.translation[e.charAt(c)],t?(a=t.pattern.toString().replace(/.{1}$|^.{1}/g,""),n=t.optional,s=t.recursive,s?(l.push(e.charAt(c)),r={digit:e.charAt(c),pattern:a}):l.push(n||s?a+"?":a)):l.push(e.charAt(c).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return i=l.join(""),r&&(i=i.replace(new RegExp("("+r.digit+"(.*"+r.digit+")?)"),"($1)?").replace(new RegExp(r.digit,"g"),r.pattern)),new RegExp(i)},destroyEvents:function(){a.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(t){var e,n=a.is("input"),s=n?"val":"text";return arguments.length>0?(a[s]()!==t&&a[s](t),e=a):e=a[s](),e},calculateCaretPosition:function(){var t=a.data("mask-previus-value")||"",e=s.getMasked(),n=s.getCaret();if(t!==e){var r=a.data("mask-previus-caret-pos")||0,o=e.length,i=t.length,l=0,c=0,u=0,k=0,f=0;for(f=n;f<o&&s.maskDigitPosMap[f];f++)c++;for(f=n-1;f>=0&&s.maskDigitPosMap[f];f--)l++;for(f=n-1;f>=0;f--)s.maskDigitPosMap[f]&&u++;for(f=r-1;f>=0;f--)s.maskDigitPosMapOld[f]&&k++;if(n>i)n=10*o;else if(r>=n&&r!==i){if(!s.maskDigitPosMapOld[n]){var v=n;n-=k-u,n-=l,s.maskDigitPosMap[n]&&(n=v)}}else n>r&&(n+=u-k,n+=c)}return n},behaviour:function(e){e=e||window.event,s.invalid=[];var n=a.data("mask-keycode");if(t.inArray(n,o.byPassKeys)===-1){var r=s.getMasked(),i=s.getCaret();return setTimeout(function(){s.setCaret(s.calculateCaretPosition())},t.jMaskGlobals.keyStrokeCompensation),s.val(r),s.setCaret(i),s.callbacks(e)}},getMasked:function(t,a){var r,i,l=[],c=void 0===a?s.val():a+"",u=0,k=e.length,f=0,v=c.length,p=1,d="push",h=-1,g=0,m=[];n.reverse?(d="unshift",p=-1,r=0,u=k-1,f=v-1,i=function(){return u>-1&&f>-1}):(r=k-1,i=function(){return u<k&&f<v});for(var M;i();){var y=e.charAt(u),b=c.charAt(f),w=o.translation[y];w?(b.match(w.pattern)?(l[d](b),w.recursive&&(h===-1?h=u:u===r&&u!==h&&(u=h-p),r===h&&(u-=p)),u+=p):b===M?(g--,M=void 0):w.optional?(u+=p,f-=p):w.fallback?(l[d](w.fallback),u+=p,f-=p):s.invalid.push({p:f,v:b,e:w.pattern}),f+=p):(t||l[d](y),b===y?(m.push(f),f+=p):(M=y,m.push(f+g),g++),u+=p)}var C=e.charAt(r);k!==v+1||o.translation[C]||l.push(C);var j=l.join("");return s.mapMaskdigitPositions(j,m,v),j},mapMaskdigitPositions:function(t,a,e){var r=n.reverse?t.length-e:0;s.maskDigitPosMap={};for(var o=0;o<a.length;o++)s.maskDigitPosMap[a[o]+r]=1},callbacks:function(t){var r=s.val(),o=r!==i,l=[r,t,a,n],c=function(t,a,e){"function"==typeof n[t]&&a&&n[t].apply(this,e)};c("onChange",o===!0,l),c("onKeyPress",o===!0,l),c("onComplete",r.length===e.length,l),c("onInvalid",s.invalid.length>0,[r,t,a,s.invalid,n])}};a=t(a);var r,o=this,i=s.val();e="function"==typeof e?e(s.val(),void 0,a,n):e,o.mask=e,o.options=n,o.remove=function(){var t=s.getCaret();return o.options.placeholder&&a.removeAttr("placeholder"),a.data("mask-maxlength")&&a.removeAttr("maxlength"),s.destroyEvents(),s.val(o.getCleanVal()),s.setCaret(t),a},o.getCleanVal=function(){return s.getMasked(!0)},o.getMaskedVal=function(t){return s.getMasked(!1,t)},o.init=function(i){if(i=i||!1,n=n||{},o.clearIfNotMatch=t.jMaskGlobals.clearIfNotMatch,o.byPassKeys=t.jMaskGlobals.byPassKeys,o.translation=t.extend({},t.jMaskGlobals.translation,n.translation),o=t.extend(!0,{},o,n),r=s.getRegexMask(),i)s.events(),s.val(s.getMasked());else{n.placeholder&&a.attr("placeholder",n.placeholder),a.data("mask")&&a.attr("autocomplete","off");for(var l=0,c=!0;l<e.length;l++){var u=o.translation[e.charAt(l)];if(u&&u.recursive){c=!1;break}}c&&a.attr("maxlength",e.length).data("mask-maxlength",!0),s.destroyEvents(),s.events();var k=s.getCaret();s.val(s.getMasked()),s.setCaret(k)}},o.init(!a.is("input"))};t.maskWatchers={};var e=function(){var e=t(this),s={},r="data-mask-",o=e.attr("data-mask");if(e.attr(r+"reverse")&&(s.reverse=!0),e.attr(r+"clearifnotmatch")&&(s.clearIfNotMatch=!0),"true"===e.attr(r+"selectonfocus")&&(s.selectOnFocus=!0),n(e,o,s))return e.data("mask",new a(this,o,s))},n=function(a,e,n){n=n||{};var s=t(a).data("mask"),r=JSON.stringify,o=t(a).val()||t(a).text();try{return"function"==typeof e&&(e=e(o)),"object"!=typeof s||r(s.options)!==r(n)||s.mask!==e}catch(i){}},s=function(t){var a,e=document.createElement("div");return t="on"+t,a=t in e,a||(e.setAttribute(t,"return;"),a="function"==typeof e[t]),e=null,a};t.fn.mask=function(e,s){s=s||{};var r=this.selector,o=t.jMaskGlobals,i=o.watchInterval,l=s.watchInputs||o.watchInputs,c=function(){if(n(this,e,s))return t(this).data("mask",new a(this,e,s))};return t(this).each(c),r&&""!==r&&l&&(clearInterval(t.maskWatchers[r]),t.maskWatchers[r]=setInterval(function(){t(document).find(r).each(c)},i)),this},t.fn.masked=function(t){return this.data("mask").getMaskedVal(t)},t.fn.unmask=function(){return clearInterval(t.maskWatchers[this.selector]),delete t.maskWatchers[this.selector],this.each(function(){var a=t(this).data("mask");a&&a.remove().removeData("mask")})},t.fn.cleanVal=function(){return this.data("mask").getCleanVal()},t.applyDataMask=function(a){a=a||t.jMaskGlobals.maskElements;var n=a instanceof t?a:t(a);n.filter(t.jMaskGlobals.dataMaskAttr).each(e)};var r={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,keyStrokeCompensation:10,useInput:!/Chrome\/[2-4][0-9]|SamsungBrowser/.test(window.navigator.userAgent)&&s("input"),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};t.jMaskGlobals=t.jMaskGlobals||{},r=t.jMaskGlobals=t.extend(!0,{},r,t.jMaskGlobals),r.dataMask&&t.applyDataMask(),setInterval(function(){t.jMaskGlobals.watchDataMask&&t.applyDataMask()},r.watchInterval)},window.jQuery,window.Zepto);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnMvanF1ZXJ5Lm1hc2suanMiXSwibmFtZXMiOlsiZmFjdG9yeSIsImpRdWVyeSIsIlplcHRvIiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsInJlcXVpcmUiLCIkIiwiTWFzayIsImVsIiwibWFzayIsIm9wdGlvbnMiLCJwIiwiaW52YWxpZCIsImdldENhcmV0Iiwic2VsIiwicG9zIiwiY3RybCIsImdldCIsImRTZWwiLCJkb2N1bWVudCIsInNlbGVjdGlvbiIsImNTZWxTdGFydCIsInNlbGVjdGlvblN0YXJ0IiwibmF2aWdhdG9yIiwiYXBwVmVyc2lvbiIsImluZGV4T2YiLCJjcmVhdGVSYW5nZSIsIm1vdmVTdGFydCIsInZhbCIsImxlbmd0aCIsInRleHQiLCJlIiwic2V0Q2FyZXQiLCJpcyIsInJhbmdlIiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJjcmVhdGVUZXh0UmFuZ2UiLCJjb2xsYXBzZSIsIm1vdmVFbmQiLCJzZWxlY3QiLCJldmVudHMiLCJvbiIsImRhdGEiLCJrZXlDb2RlIiwid2hpY2giLCJtYXNrRGlnaXRQb3NNYXBPbGQiLCJtYXNrRGlnaXRQb3NNYXAiLCJqTWFza0dsb2JhbHMiLCJ1c2VJbnB1dCIsImJlaGF2aW91ciIsInNldFRpbWVvdXQiLCJrZXlkb3duIiwia2V5dXAiLCJvbGRWYWx1ZSIsInRyaWdnZXIiLCJzZWxlY3RPbkZvY3VzIiwidGFyZ2V0IiwiY2xlYXJJZk5vdE1hdGNoIiwicmVnZXhNYXNrIiwidGVzdCIsImdldFJlZ2V4TWFzayIsInRyYW5zbGF0aW9uIiwicGF0dGVybiIsIm9wdGlvbmFsIiwicmVjdXJzaXZlIiwib1JlY3Vyc2l2ZSIsInIiLCJtYXNrQ2h1bmtzIiwiaSIsImpNYXNrIiwiY2hhckF0IiwidG9TdHJpbmciLCJyZXBsYWNlIiwicHVzaCIsImRpZ2l0Iiwiam9pbiIsIlJlZ0V4cCIsImRlc3Ryb3lFdmVudHMiLCJvZmYiLCJ2IiwiaXNJbnB1dCIsIm1ldGhvZCIsImFyZ3VtZW50cyIsImNhbGN1bGF0ZUNhcmV0UG9zaXRpb24iLCJvbGRWYWwiLCJuZXdWYWwiLCJnZXRNYXNrZWQiLCJjYXJldFBvc05ldyIsImNhcmV0UG9zT2xkIiwibmV3VmFsTCIsIm9sZFZhbEwiLCJtYXNrRGlnaXRzQmVmb3JlQ2FyZXQiLCJtYXNrRGlnaXRzQWZ0ZXJDYXJldCIsIm1hc2tEaWdpdHNCZWZvcmVDYXJldEFsbCIsIm1hc2tEaWdpdHNCZWZvcmVDYXJldEFsbE9sZCIsImNhcmV0UG9zIiwid2luZG93IiwiZXZlbnQiLCJpbkFycmF5IiwiYnlQYXNzS2V5cyIsImtleVN0cm9rZUNvbXBlbnNhdGlvbiIsImNhbGxiYWNrcyIsInNraXBNYXNrQ2hhcnMiLCJsYXN0TWFza0NoYXIiLCJjaGVjayIsImJ1ZiIsInZhbHVlIiwidW5kZWZpbmVkIiwibSIsIm1hc2tMZW4iLCJ2YWxMZW4iLCJvZmZzZXQiLCJhZGRNZXRob2QiLCJyZXNldFBvcyIsIm1hc2tEaWdpdENvdW50IiwibWFza0RpZ2l0UG9zQXJyIiwicmV2ZXJzZSIsImxhc3RVbnRyYW5zbGF0ZWRNYXNrQ2hhciIsIm1hc2tEaWdpdCIsInZhbERpZ2l0IiwibWF0Y2giLCJmYWxsYmFjayIsImxhc3RNYXNrQ2hhckRpZ2l0IiwibWFwTWFza2RpZ2l0UG9zaXRpb25zIiwibWFza0RpZmYiLCJjaGFuZ2VkIiwiZGVmYXVsdEFyZ3MiLCJjYWxsYmFjayIsIm5hbWUiLCJjcml0ZXJpYSIsImFyZ3MiLCJhcHBseSIsInRoaXMiLCJyZW1vdmUiLCJjYXJldCIsInBsYWNlaG9sZGVyIiwicmVtb3ZlQXR0ciIsImdldENsZWFuVmFsIiwiZ2V0TWFza2VkVmFsIiwiaW5pdCIsIm9ubHlNYXNrIiwiZXh0ZW5kIiwiYXR0ciIsIm1heGxlbmd0aCIsIm1hc2tXYXRjaGVycyIsIkhUTUxBdHRyaWJ1dGVzIiwiaW5wdXQiLCJwcmVmaXgiLCJub3RTYW1lTWFza09iamVjdCIsImZpZWxkIiwibWFza09iamVjdCIsInN0cmluZ2lmeSIsIkpTT04iLCJldmVudFN1cHBvcnRlZCIsImV2ZW50TmFtZSIsImlzU3VwcG9ydGVkIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImZuIiwic2VsZWN0b3IiLCJnbG9iYWxzIiwiaW50ZXJ2YWwiLCJ3YXRjaEludGVydmFsIiwid2F0Y2hJbnB1dHMiLCJtYXNrRnVuY3Rpb24iLCJlYWNoIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiZmluZCIsIm1hc2tlZCIsInVubWFzayIsImRhdGFNYXNrIiwicmVtb3ZlRGF0YSIsImNsZWFuVmFsIiwiYXBwbHlEYXRhTWFzayIsIm1hc2tFbGVtZW50cyIsIiRzZWxlY3RvciIsImZpbHRlciIsImRhdGFNYXNrQXR0ciIsInVzZXJBZ2VudCIsIndhdGNoRGF0YU1hc2siLCIwIiwiOSIsIiMiLCJBIiwiUyJdLCJtYXBwaW5ncyI6IkNBdUNDLFNBQVVBLEVBQVNDLEVBQVFDLEdBRUYsa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUN2Q0QsUUFBUSxVQUFXSCxHQUNPLGdCQUFaSyxTQUNkQyxPQUFPRCxRQUFVTCxFQUFRTyxRQUFRLFdBRWpDUCxFQUFRQyxHQUFVQyxJQUd4QixTQUFVTSxHQUNSLFlBRUEsSUFBSUMsR0FBTyxTQUFVQyxFQUFJQyxFQUFNQyxHQUUzQixHQUFJQyxJQUNBQyxXQUNBQyxTQUFVLFdBQ04sSUFDSSxHQUFJQyxHQUNBQyxFQUFNLEVBQ05DLEVBQU9SLEVBQUdTLElBQUksR0FDZEMsRUFBT0MsU0FBU0MsVUFDaEJDLEVBQVlMLEVBQUtNLGNBYXJCLE9BVklKLElBQVFLLFVBQVVDLFdBQVdDLFFBQVEsaUJBQ3JDWCxFQUFNSSxFQUFLUSxjQUNYWixFQUFJYSxVQUFVLGFBQWNoQixFQUFFaUIsTUFBTUMsUUFDcENkLEVBQU1ELEVBQUlnQixLQUFLRCxTQUdWUixHQUEyQixNQUFkQSxLQUNsQk4sRUFBTU0sR0FHSE4sRUFDVCxNQUFPZ0IsTUFFYkMsU0FBVSxTQUFTakIsR0FDZixJQUNJLEdBQUlQLEVBQUd5QixHQUFHLFVBQVcsQ0FDakIsR0FBSUMsR0FBT2xCLEVBQU9SLEVBQUdTLElBQUksRUFHckJELEdBQUttQixrQkFDTG5CLEVBQUttQixrQkFBa0JwQixFQUFLQSxJQUU1Qm1CLEVBQVFsQixFQUFLb0Isa0JBQ2JGLEVBQU1HLFVBQVMsR0FDZkgsRUFBTUksUUFBUSxZQUFhdkIsR0FDM0JtQixFQUFNUCxVQUFVLFlBQWFaLEdBQzdCbUIsRUFBTUssV0FHaEIsTUFBT1IsTUFFYlMsT0FBUSxXQUNKaEMsRUFDQ2lDLEdBQUcsZUFBZ0IsU0FBU1YsR0FDekJ2QixFQUFHa0MsS0FBSyxlQUFnQlgsRUFBRVksU0FBV1osRUFBRWEsT0FDdkNwQyxFQUFHa0MsS0FBSyxxQkFBc0JsQyxFQUFHb0IsT0FDakNwQixFQUFHa0MsS0FBSyx5QkFBMEIvQixFQUFFRSxZQUNwQ0YsRUFBRWtDLG1CQUFxQmxDLEVBQUVtQyxrQkFFNUJMLEdBQUduQyxFQUFFeUMsYUFBYUMsU0FBVyxhQUFlLGFBQWNyQyxFQUFFc0MsV0FDNURSLEdBQUcsdUJBQXdCLFdBQ3hCUyxXQUFXLFdBQ1AxQyxFQUFHMkMsVUFBVUMsU0FDZCxPQUVOWCxHQUFHLGNBQWUsV0FDZmpDLEVBQUdrQyxLQUFLLFdBQVcsS0FFdEJELEdBQUcsWUFBYSxXQUNUWSxJQUFhMUMsRUFBRWlCLE9BQVVwQixFQUFHa0MsS0FBSyxZQUNqQ2xDLEVBQUc4QyxRQUFRLFVBRWY5QyxFQUFHa0MsS0FBSyxXQUFXLEtBSXRCRCxHQUFHLFlBQWEsV0FDYlksRUFBVzFDLEVBQUVpQixRQUdoQmEsR0FBRyxhQUFjLFNBQVVWLEdBQ3BCckIsRUFBUTZDLGlCQUFrQixHQUMxQmpELEVBQUV5QixFQUFFeUIsUUFBUWpCLFdBSW5CRSxHQUFHLGdCQUFpQixXQUNiL0IsRUFBUStDLGtCQUFvQkMsRUFBVUMsS0FBS2hELEVBQUVpQixRQUM5Q2pCLEVBQUVpQixJQUFJLE9BSWpCZ0MsYUFBYyxXQUdWLElBQUssR0FGZ0JDLEdBQWFDLEVBQVNDLEVBQVVDLEVBQVdDLEVBQVlDLEVBQXhFQyxLQUVLQyxFQUFJLEVBQUdBLEVBQUkzRCxFQUFLb0IsT0FBUXVDLElBQzdCUCxFQUFjUSxFQUFNUixZQUFZcEQsRUFBSzZELE9BQU9GLElBRXhDUCxHQUVBQyxFQUFVRCxFQUFZQyxRQUFRUyxXQUFXQyxRQUFRLGVBQWdCLElBQ2pFVCxFQUFXRixFQUFZRSxTQUN2QkMsRUFBWUgsRUFBWUcsVUFFcEJBLEdBQ0FHLEVBQVdNLEtBQUtoRSxFQUFLNkQsT0FBT0YsSUFDNUJILEdBQWNTLE1BQU9qRSxFQUFLNkQsT0FBT0YsR0FBSU4sUUFBU0EsSUFFOUNLLEVBQVdNLEtBQU1WLEdBQWFDLEVBQXVCRixFQUFVLElBQXJCQSxJQUk5Q0ssRUFBV00sS0FBS2hFLEVBQUs2RCxPQUFPRixHQUFHSSxRQUFRLHlCQUEwQixRQVd6RSxPQVBBTixHQUFJQyxFQUFXUSxLQUFLLElBRWhCVixJQUNBQyxFQUFJQSxFQUFFTSxRQUFRLEdBQUlJLFFBQU8sSUFBTVgsRUFBV1MsTUFBUSxNQUFRVCxFQUFXUyxNQUFRLE9BQVEsU0FDL0VGLFFBQVEsR0FBSUksUUFBT1gsRUFBV1MsTUFBTyxLQUFNVCxFQUFXSCxVQUd6RCxHQUFJYyxRQUFPVixJQUV0QlcsY0FBZSxXQUNYckUsRUFBR3NFLEtBQUssUUFBUyxVQUFXLFFBQVMsUUFBUyxPQUFRLE9BQVEsV0FBWSxJQUFJSCxLQUFLLFlBRXZGL0MsSUFBSyxTQUFTbUQsR0FDVixHQUVJYixHQUZBYyxFQUFVeEUsRUFBR3lCLEdBQUcsU0FDaEJnRCxFQUFTRCxFQUFVLE1BQVEsTUFZL0IsT0FUSUUsV0FBVXJELE9BQVMsR0FDZnJCLEVBQUd5RSxPQUFjRixHQUNqQnZFLEVBQUd5RSxHQUFRRixHQUVmYixFQUFJMUQsR0FFSjBELEVBQUkxRCxFQUFHeUUsS0FHSmYsR0FFWGlCLHVCQUF3QixXQUNwQixHQUFJQyxHQUFTNUUsRUFBR2tDLEtBQUssdUJBQXlCLEdBQzFDMkMsRUFBUzFFLEVBQUUyRSxZQUNYQyxFQUFjNUUsRUFBRUUsVUFDcEIsSUFBSXVFLElBQVdDLEVBQVEsQ0FDbkIsR0FBSUcsR0FBY2hGLEVBQUdrQyxLQUFLLDJCQUE2QixFQUNuRCtDLEVBQVVKLEVBQU94RCxPQUNqQjZELEVBQVVOLEVBQU92RCxPQUNqQjhELEVBQXdCLEVBQ3hCQyxFQUF1QixFQUN2QkMsRUFBMkIsRUFDM0JDLEVBQThCLEVBQzlCMUIsRUFBSSxDQUVSLEtBQUtBLEVBQUltQixFQUFhbkIsRUFBSXFCLEdBQ2pCOUUsRUFBRW1DLGdCQUFnQnNCLEdBRFFBLElBSS9Cd0IsR0FHSixLQUFLeEIsRUFBSW1CLEVBQWMsRUFBR25CLEdBQUssR0FDdEJ6RCxFQUFFbUMsZ0JBQWdCc0IsR0FET0EsSUFJOUJ1QixHQUdKLEtBQUt2QixFQUFJbUIsRUFBYyxFQUFHbkIsR0FBSyxFQUFHQSxJQUMxQnpELEVBQUVtQyxnQkFBZ0JzQixJQUNsQnlCLEdBSVIsS0FBS3pCLEVBQUlvQixFQUFjLEVBQUdwQixHQUFLLEVBQUdBLElBQzFCekQsRUFBRWtDLG1CQUFtQnVCLElBQ3JCMEIsR0FLUixJQUFJUCxFQUFjRyxFQUNoQkgsRUFBd0IsR0FBVkUsTUFDVCxJQUFJRCxHQUFlRCxHQUFlQyxJQUFnQkUsR0FDckQsSUFBSy9FLEVBQUVrQyxtQkFBbUIwQyxHQUFlLENBQ3ZDLEdBQUlRLEdBQVdSLENBQ2ZBLElBQWVPLEVBQThCRCxFQUM3Q04sR0FBZUksRUFDWGhGLEVBQUVtQyxnQkFBZ0J5QyxLQUNwQkEsRUFBY1EsUUFJYlIsR0FBY0MsSUFDbkJELEdBQWVNLEVBQTJCQyxFQUMxQ1AsR0FBZUssR0FHdkIsTUFBT0wsSUFFWHRDLFVBQVcsU0FBU2xCLEdBQ2hCQSxFQUFJQSxHQUFLaUUsT0FBT0MsTUFDaEJ0RixFQUFFQyxVQUVGLElBQUkrQixHQUFVbkMsRUFBR2tDLEtBQUssZUFFdEIsSUFBSXBDLEVBQUU0RixRQUFRdkQsRUFBUzBCLEVBQU04QixpQkFBb0IsQ0FDN0MsR0FBSWQsR0FBUzFFLEVBQUUyRSxZQUNYUyxFQUFXcEYsRUFBRUUsVUFVakIsT0FOQXFDLFlBQVcsV0FDVHZDLEVBQUVxQixTQUFTckIsRUFBRXdFLDJCQUNaN0UsRUFBRXlDLGFBQWFxRCx1QkFFbEJ6RixFQUFFaUIsSUFBSXlELEdBQ04xRSxFQUFFcUIsU0FBUytELEdBQ0pwRixFQUFFMEYsVUFBVXRFLEtBRzNCdUQsVUFBVyxTQUFTZ0IsRUFBZTFFLEdBQy9CLEdBUUkyRSxHQUNBQyxFQVRBQyxLQUNBQyxFQUFnQkMsU0FBUi9FLEVBQW9CakIsRUFBRWlCLE1BQVFBLEVBQU0sR0FDNUNnRixFQUFJLEVBQUdDLEVBQVVwRyxFQUFLb0IsT0FDdEJrRCxFQUFJLEVBQUcrQixFQUFTSixFQUFNN0UsT0FDdEJrRixFQUFTLEVBQUdDLEVBQVksT0FDeEJDLEtBQ0FDLEVBQWlCLEVBQ2pCQyxJQUlBekcsR0FBUTBHLFNBQ1JKLEVBQVksVUFDWkQsS0FDQVIsRUFBZSxFQUNmSyxFQUFJQyxFQUFVLEVBQ2Q5QixFQUFJK0IsRUFBUyxFQUNiTixFQUFRLFdBQ0osTUFBT0ksT0FBVTdCLFFBR3JCd0IsRUFBZU0sRUFBVSxFQUN6QkwsRUFBUSxXQUNKLE1BQU9JLEdBQUlDLEdBQVc5QixFQUFJK0IsR0FLbEMsS0FEQSxHQUFJTyxHQUNHYixLQUFTLENBQ1osR0FBSWMsR0FBWTdHLEVBQUs2RCxPQUFPc0MsR0FDeEJXLEVBQVdiLEVBQU1wQyxPQUFPUyxHQUN4QmxCLEVBQWNRLEVBQU1SLFlBQVl5RCxFQUVoQ3pELElBQ0kwRCxFQUFTQyxNQUFNM0QsRUFBWUMsVUFDM0IyQyxFQUFJTyxHQUFXTyxHQUNWMUQsRUFBWUcsWUFDVGlELE9BQ0FBLEVBQVdMLEVBQ0pBLElBQU1MLEdBQWdCSyxJQUFNSyxJQUNuQ0wsRUFBSUssRUFBV0YsR0FHZlIsSUFBaUJVLElBQ2pCTCxHQUFLRyxJQUdiSCxHQUFLRyxHQUNFUSxJQUFhRixHQUlwQkgsSUFDQUcsRUFBMkJWLFFBQ3BCOUMsRUFBWUUsVUFDbkI2QyxHQUFLRyxFQUNMaEMsR0FBS2dDLEdBQ0VsRCxFQUFZNEQsVUFDbkJoQixFQUFJTyxHQUFXbkQsRUFBWTRELFVBQzNCYixHQUFLRyxFQUNMaEMsR0FBS2dDLEdBRVBwRyxFQUFFQyxRQUFRNkQsTUFBTTlELEVBQUdvRSxFQUFHQSxFQUFHd0MsRUFBVXhGLEVBQUc4QixFQUFZQyxVQUVwRGlCLEdBQUtnQyxJQUVBVCxHQUNERyxFQUFJTyxHQUFXTSxHQUdmQyxJQUFhRCxHQUNiSCxFQUFnQjFDLEtBQUtNLEdBQ3JCQSxHQUFLZ0MsSUFFTE0sRUFBMkJDLEVBQzNCSCxFQUFnQjFDLEtBQUtNLEVBQUltQyxHQUN6QkEsS0FHSk4sR0FBS0csR0FJYixHQUFJVyxHQUFvQmpILEVBQUs2RCxPQUFPaUMsRUFDaENNLEtBQVlDLEVBQVMsR0FBTXpDLEVBQU1SLFlBQVk2RCxJQUM3Q2pCLEVBQUloQyxLQUFLaUQsRUFHYixJQUFJckMsR0FBU29CLEVBQUk5QixLQUFLLEdBRXRCLE9BREFoRSxHQUFFZ0gsc0JBQXNCdEMsRUFBUThCLEVBQWlCTCxHQUMxQ3pCLEdBRVhzQyxzQkFBdUIsU0FBU3RDLEVBQVE4QixFQUFpQkwsR0FDdkQsR0FBSWMsR0FBV2xILEVBQVEwRyxRQUFVL0IsRUFBT3hELE9BQVNpRixFQUFTLENBQzFEbkcsR0FBRW1DLGtCQUNGLEtBQUssR0FBSXNCLEdBQUksRUFBR0EsRUFBSStDLEVBQWdCdEYsT0FBUXVDLElBQzFDekQsRUFBRW1DLGdCQUFnQnFFLEVBQWdCL0MsR0FBS3dELEdBQVksR0FHdkR2QixVQUFXLFNBQVV0RSxHQUNqQixHQUFJSCxHQUFNakIsRUFBRWlCLE1BQ1JpRyxFQUFVakcsSUFBUXlCLEVBQ2xCeUUsR0FBZWxHLEVBQUtHLEVBQUd2QixFQUFJRSxHQUMzQnFILEVBQVcsU0FBU0MsRUFBTUMsRUFBVUMsR0FDSCxrQkFBbEJ4SCxHQUFRc0gsSUFBd0JDLEdBQ3ZDdkgsRUFBUXNILEdBQU1HLE1BQU1DLEtBQU1GLEdBSXRDSCxHQUFTLFdBQVlGLEtBQVksRUFBTUMsR0FDdkNDLEVBQVMsYUFBY0YsS0FBWSxFQUFNQyxHQUN6Q0MsRUFBUyxhQUFjbkcsRUFBSUMsU0FBV3BCLEVBQUtvQixPQUFRaUcsR0FDbkRDLEVBQVMsWUFBYXBILEVBQUVDLFFBQVFpQixPQUFTLEdBQUlELEVBQUtHLEVBQUd2QixFQUFJRyxFQUFFQyxRQUFTRixLQUk1RUYsR0FBS0YsRUFBRUUsRUFDUCxJQUFzQ2tELEdBQWxDVyxFQUFRK0QsS0FBTS9FLEVBQVcxQyxFQUFFaUIsS0FFL0JuQixHQUF1QixrQkFBVEEsR0FBc0JBLEVBQUtFLEVBQUVpQixNQUFPK0UsT0FBV25HLEVBQUtFLEdBQVdELEVBRzdFNEQsRUFBTTVELEtBQU9BLEVBQ2I0RCxFQUFNM0QsUUFBVUEsRUFDaEIyRCxFQUFNZ0UsT0FBUyxXQUNYLEdBQUlDLEdBQVEzSCxFQUFFRSxVQVVkLE9BVEl3RCxHQUFNM0QsUUFBUTZILGFBQ2QvSCxFQUFHZ0ksV0FBVyxlQUVkaEksRUFBR2tDLEtBQUssbUJBQ1JsQyxFQUFHZ0ksV0FBVyxhQUVsQjdILEVBQUVrRSxnQkFDRmxFLEVBQUVpQixJQUFJeUMsRUFBTW9FLGVBQ1o5SCxFQUFFcUIsU0FBU3NHLEdBQ0o5SCxHQUlYNkQsRUFBTW9FLFlBQWMsV0FDakIsTUFBTzlILEdBQUUyRSxXQUFVLElBSXRCakIsRUFBTXFFLGFBQWUsU0FBUzlHLEdBQzNCLE1BQU9qQixHQUFFMkUsV0FBVSxFQUFPMUQsSUFHOUJ5QyxFQUFNc0UsS0FBTyxTQUFTQyxHQVlqQixHQVhBQSxFQUFXQSxJQUFZLEVBQ3ZCbEksRUFBVUEsTUFFVjJELEVBQU1aLGdCQUFtQm5ELEVBQUV5QyxhQUFhVSxnQkFDeENZLEVBQU04QixXQUFtQjdGLEVBQUV5QyxhQUFhb0QsV0FDeEM5QixFQUFNUixZQUFtQnZELEVBQUV1SSxVQUFXdkksRUFBRXlDLGFBQWFjLFlBQWFuRCxFQUFRbUQsYUFFMUVRLEVBQVEvRCxFQUFFdUksUUFBTyxLQUFVeEUsRUFBTzNELEdBRWxDZ0QsRUFBWS9DLEVBQUVpRCxlQUVWZ0YsRUFDQWpJLEVBQUU2QixTQUNGN0IsRUFBRWlCLElBQUlqQixFQUFFMkUsaUJBQ0wsQ0FDQzVFLEVBQVE2SCxhQUNSL0gsRUFBR3NJLEtBQUssY0FBZ0JwSSxFQUFRNkgsYUFNaEMvSCxFQUFHa0MsS0FBSyxTQUNWbEMsRUFBR3NJLEtBQUssZUFBZ0IsTUFLMUIsS0FBSyxHQUFJMUUsR0FBSSxFQUFHMkUsR0FBWSxFQUFNM0UsRUFBSTNELEVBQUtvQixPQUFRdUMsSUFBSyxDQUNwRCxHQUFJUCxHQUFjUSxFQUFNUixZQUFZcEQsRUFBSzZELE9BQU9GLEdBQ2hELElBQUlQLEdBQWVBLEVBQVlHLFVBQVcsQ0FDdEMrRSxHQUFZLENBQ1osUUFJSkEsR0FDQXZJLEVBQUdzSSxLQUFLLFlBQWFySSxFQUFLb0IsUUFBUWEsS0FBSyxrQkFBa0IsR0FHN0QvQixFQUFFa0UsZ0JBQ0ZsRSxFQUFFNkIsUUFFRixJQUFJOEYsR0FBUTNILEVBQUVFLFVBQ2RGLEdBQUVpQixJQUFJakIsRUFBRTJFLGFBQ1IzRSxFQUFFcUIsU0FBU3NHLEtBSW5CakUsRUFBTXNFLE1BQU1uSSxFQUFHeUIsR0FBRyxVQUd0QjNCLEdBQUUwSSxlQUNGLElBQUlDLEdBQWlCLFdBQ2pCLEdBQUlDLEdBQVE1SSxFQUFFOEgsTUFDVjFILEtBQ0F5SSxFQUFTLGFBQ1QxSSxFQUFPeUksRUFBTUosS0FBSyxZQWN0QixJQVpJSSxFQUFNSixLQUFLSyxFQUFTLGFBQ3BCekksRUFBUTBHLFNBQVUsR0FHbEI4QixFQUFNSixLQUFLSyxFQUFTLHFCQUNwQnpJLEVBQVErQyxpQkFBa0IsR0FHZSxTQUF6Q3lGLEVBQU1KLEtBQUtLLEVBQVMsbUJBQ3JCekksRUFBUTZDLGVBQWdCLEdBR3ZCNkYsRUFBa0JGLEVBQU96SSxFQUFNQyxHQUMvQixNQUFPd0ksR0FBTXhHLEtBQUssT0FBUSxHQUFJbkMsR0FBSzZILEtBQU0zSCxFQUFNQyxLQUd2RDBJLEVBQW9CLFNBQVNDLEVBQU81SSxFQUFNQyxHQUN0Q0EsRUFBVUEsS0FDVixJQUFJNEksR0FBYWhKLEVBQUUrSSxHQUFPM0csS0FBSyxRQUMzQjZHLEVBQVlDLEtBQUtELFVBQ2pCN0MsRUFBUXBHLEVBQUUrSSxHQUFPekgsT0FBU3RCLEVBQUUrSSxHQUFPdkgsTUFDdkMsS0FJSSxNQUhvQixrQkFBVHJCLEtBQ1BBLEVBQU9BLEVBQUtpRyxJQUVhLGdCQUFmNEMsSUFBMkJDLEVBQVVELEVBQVc1SSxXQUFhNkksRUFBVTdJLElBQVk0SSxFQUFXN0ksT0FBU0EsRUFDdkgsTUFBT3NCLE1BRWIwSCxFQUFpQixTQUFTQyxHQUN0QixHQUF3Q0MsR0FBcENuSixFQUFLVyxTQUFTeUksY0FBYyxNQVdoQyxPQVRBRixHQUFZLEtBQU9BLEVBQ25CQyxFQUFlRCxJQUFhbEosR0FFdEJtSixJQUNGbkosRUFBR3FKLGFBQWFILEVBQVcsV0FDM0JDLEVBQXVDLGtCQUFsQm5KLEdBQUdrSixJQUU1QmxKLEVBQUssS0FFRW1KLEVBR1hySixHQUFFd0osR0FBR3JKLEtBQU8sU0FBU0EsRUFBTUMsR0FDdkJBLEVBQVVBLEtBQ1YsSUFBSXFKLEdBQVczQixLQUFLMkIsU0FDaEJDLEVBQVUxSixFQUFFeUMsYUFDWmtILEVBQVdELEVBQVFFLGNBQ25CQyxFQUFjekosRUFBUXlKLGFBQWVILEVBQVFHLFlBQzdDQyxFQUFlLFdBQ1gsR0FBSWhCLEVBQWtCaEIsS0FBTTNILEVBQU1DLEdBQzlCLE1BQU9KLEdBQUU4SCxNQUFNMUYsS0FBSyxPQUFRLEdBQUluQyxHQUFLNkgsS0FBTTNILEVBQU1DLElBWTdELE9BUkFKLEdBQUU4SCxNQUFNaUMsS0FBS0QsR0FFVEwsR0FBeUIsS0FBYkEsR0FBbUJJLElBQy9CRyxjQUFjaEssRUFBRTBJLGFBQWFlLElBQzdCekosRUFBRTBJLGFBQWFlLEdBQVlRLFlBQVksV0FDbkNqSyxFQUFFYSxVQUFVcUosS0FBS1QsR0FBVU0sS0FBS0QsSUFDakNILElBRUE3QixNQUdYOUgsRUFBRXdKLEdBQUdXLE9BQVMsU0FBUzdJLEdBQ25CLE1BQU93RyxNQUFLMUYsS0FBSyxRQUFRZ0csYUFBYTlHLElBRzFDdEIsRUFBRXdKLEdBQUdZLE9BQVMsV0FHVixNQUZBSixlQUFjaEssRUFBRTBJLGFBQWFaLEtBQUsyQixpQkFDM0J6SixHQUFFMEksYUFBYVosS0FBSzJCLFVBQ3BCM0IsS0FBS2lDLEtBQUssV0FDYixHQUFJTSxHQUFXckssRUFBRThILE1BQU0xRixLQUFLLE9BQ3hCaUksSUFDQUEsRUFBU3RDLFNBQVN1QyxXQUFXLFdBS3pDdEssRUFBRXdKLEdBQUdlLFNBQVcsV0FDWixNQUFPekMsTUFBSzFGLEtBQUssUUFBUStGLGVBRzdCbkksRUFBRXdLLGNBQWdCLFNBQVNmLEdBQ3ZCQSxFQUFXQSxHQUFZekosRUFBRXlDLGFBQWFnSSxZQUN0QyxJQUFJQyxHQUFhakIsWUFBb0J6SixHQUFLeUosRUFBV3pKLEVBQUV5SixFQUN2RGlCLEdBQVVDLE9BQU8zSyxFQUFFeUMsYUFBYW1JLGNBQWNiLEtBQUtwQixHQUd2RCxJQUFJZSxJQUNBZSxhQUFjLG9CQUNkRyxhQUFjLGVBQ2RQLFVBQVUsRUFDVlQsY0FBZSxJQUNmQyxhQUFhLEVBQ2IvRCxzQkFBdUIsR0FFdkJwRCxVQUFXLG9DQUFvQ1csS0FBS3FDLE9BQU96RSxVQUFVNEosWUFBYzFCLEVBQWUsU0FDbEcyQixlQUFlLEVBQ2ZqRixZQUFhLEVBQUcsR0FBSSxHQUFJLEdBQUksR0FBSSxHQUFJLEdBQUksR0FBSSxHQUFJLElBQ2hEdEMsYUFDSXdILEdBQU12SCxRQUFTLE1BQ2Z3SCxHQUFNeEgsUUFBUyxLQUFNQyxVQUFVLEdBQy9Cd0gsS0FBTXpILFFBQVMsS0FBTUUsV0FBVyxHQUNoQ3dILEdBQU0xSCxRQUFTLGVBQ2YySCxHQUFNM0gsUUFBUyxhQUl2QnhELEdBQUV5QyxhQUFlekMsRUFBRXlDLGlCQUNuQmlILEVBQVUxSixFQUFFeUMsYUFBZXpDLEVBQUV1SSxRQUFPLEtBQVVtQixFQUFTMUosRUFBRXlDLGNBR3JEaUgsRUFBUVcsVUFDUnJLLEVBQUV3SyxnQkFHTlAsWUFBWSxXQUNKakssRUFBRXlDLGFBQWFxSSxlQUNmOUssRUFBRXdLLGlCQUVQZCxFQUFRRSxnQkFDWmxFLE9BQU9qRyxPQUFRaUcsT0FBT2hHIiwiZmlsZSI6ImxpYnMvanF1ZXJ5Lm1hc2suanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICoganF1ZXJ5Lm1hc2suanNcclxuICogQHZlcnNpb246IHYxLjE0LjE1XHJcbiAqIEBhdXRob3I6IElnb3IgRXNjb2JhclxyXG4gKlxyXG4gKiBDcmVhdGVkIGJ5IElnb3IgRXNjb2JhciBvbiAyMDEyLTAzLTEwLiBQbGVhc2UgcmVwb3J0IGFueSBidWcgYXQgZ2l0aHViLmNvbS9pZ29yZXNjb2Jhci9qUXVlcnktTWFzay1QbHVnaW5cclxuICpcclxuICogQ29weXJpZ2h0IChjKSAyMDEyIElnb3IgRXNjb2JhciBodHRwOi8vaWdvcmVzY29iYXIuY29tXHJcbiAqXHJcbiAqIFRoZSBNSVQgTGljZW5zZSAoaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHApXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uXHJcbiAqIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uXHJcbiAqIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dFxyXG4gKiByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSxcclxuICogY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlXHJcbiAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nXHJcbiAqIGNvbmRpdGlvbnM6XHJcbiAqXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlXHJcbiAqIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4gKlxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELFxyXG4gKiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVNcclxuICogT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcclxuICogTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFRcclxuICogSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksXHJcbiAqIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lOR1xyXG4gKiBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SXHJcbiAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4vKiBqc2hpbnQgbGF4YnJlYWs6IHRydWUgKi9cclxuLyoganNoaW50IG1heGNvbXBsZXhpdHk6MTcgKi9cclxuLyogZ2xvYmFsIGRlZmluZSAqL1xyXG5cclxuLy8gVU1EIChVbml2ZXJzYWwgTW9kdWxlIERlZmluaXRpb24pIHBhdHRlcm5zIGZvciBKYXZhU2NyaXB0IG1vZHVsZXMgdGhhdCB3b3JrIGV2ZXJ5d2hlcmUuXHJcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS91bWRqcy91bWQvYmxvYi9tYXN0ZXIvdGVtcGxhdGVzL2pxdWVyeVBsdWdpbi5qc1xyXG4oZnVuY3Rpb24gKGZhY3RvcnksIGpRdWVyeSwgWmVwdG8pIHtcclxuXHJcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XHJcbiAgICAgICAgZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnanF1ZXJ5JykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmYWN0b3J5KGpRdWVyeSB8fCBaZXB0byk7XHJcbiAgICB9XHJcblxyXG59KGZ1bmN0aW9uICgkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIE1hc2sgPSBmdW5jdGlvbiAoZWwsIG1hc2ssIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgICAgdmFyIHAgPSB7XHJcbiAgICAgICAgICAgIGludmFsaWQ6IFtdLFxyXG4gICAgICAgICAgICBnZXRDYXJldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdHJsID0gZWwuZ2V0KDApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkU2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjU2VsU3RhcnQgPSBjdHJsLnNlbGVjdGlvblN0YXJ0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBJRSBTdXBwb3J0XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRTZWwgJiYgbmF2aWdhdG9yLmFwcFZlcnNpb24uaW5kZXhPZignTVNJRSAxMCcpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWwgPSBkU2VsLmNyZWF0ZVJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbC5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIC1wLnZhbCgpLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHNlbC50ZXh0Lmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRmlyZWZveCBzdXBwb3J0XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY1NlbFN0YXJ0IHx8IGNTZWxTdGFydCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IGNTZWxTdGFydDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwb3M7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXRDYXJldDogZnVuY3Rpb24ocG9zKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbC5pcygnOmZvY3VzJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlLCBjdHJsID0gZWwuZ2V0KDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyZWZveCwgV2ViS2l0LCBldGMuLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3RybC5zZXRTZWxlY3Rpb25SYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5zZXRTZWxlY3Rpb25SYW5nZShwb3MsIHBvcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIElFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZSA9IGN0cmwuY3JlYXRlVGV4dFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVFbmQoJ2NoYXJhY3RlcicsIHBvcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIHBvcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3QoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGV2ZW50czogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBlbFxyXG4gICAgICAgICAgICAgICAgLm9uKCdrZXlkb3duLm1hc2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuZGF0YSgnbWFzay1rZXljb2RlJywgZS5rZXlDb2RlIHx8IGUud2hpY2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLmRhdGEoJ21hc2stcHJldml1cy12YWx1ZScsIGVsLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICBlbC5kYXRhKCdtYXNrLXByZXZpdXMtY2FyZXQtcG9zJywgcC5nZXRDYXJldCgpKTtcclxuICAgICAgICAgICAgICAgICAgICBwLm1hc2tEaWdpdFBvc01hcE9sZCA9IHAubWFza0RpZ2l0UG9zTWFwO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5vbigkLmpNYXNrR2xvYmFscy51c2VJbnB1dCA/ICdpbnB1dC5tYXNrJyA6ICdrZXl1cC5tYXNrJywgcC5iZWhhdmlvdXIpXHJcbiAgICAgICAgICAgICAgICAub24oJ3Bhc3RlLm1hc2sgZHJvcC5tYXNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwua2V5ZG93bigpLmtleXVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAub24oJ2NoYW5nZS5tYXNrJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBlbC5kYXRhKCdjaGFuZ2VkJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm9uKCdibHVyLm1hc2snLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRWYWx1ZSAhPT0gcC52YWwoKSAmJiAhZWwuZGF0YSgnY2hhbmdlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnRyaWdnZXIoJ2NoYW5nZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbC5kYXRhKCdjaGFuZ2VkJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC8vIGl0J3MgdmVyeSBpbXBvcnRhbnQgdGhhdCB0aGlzIGNhbGxiYWNrIHJlbWFpbnMgaW4gdGhpcyBwb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgLy8gb3RoZXJ3aGlzZSBvbGRWYWx1ZSBpdCdzIGdvaW5nIHRvIHdvcmsgYnVnZ3lcclxuICAgICAgICAgICAgICAgIC5vbignYmx1ci5tYXNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2xkVmFsdWUgPSBwLnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC8vIHNlbGVjdCBhbGwgdGV4dCBvbiBmb2N1c1xyXG4gICAgICAgICAgICAgICAgLm9uKCdmb2N1cy5tYXNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zZWxlY3RPbkZvY3VzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnNlbGVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyBjbGVhciB0aGUgdmFsdWUgaWYgaXQgbm90IGNvbXBsZXRlIHRoZSBtYXNrXHJcbiAgICAgICAgICAgICAgICAub24oJ2ZvY3Vzb3V0Lm1hc2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5jbGVhcklmTm90TWF0Y2ggJiYgIXJlZ2V4TWFzay50ZXN0KHAudmFsKCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgcC52YWwoJycpO1xyXG4gICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldFJlZ2V4TWFzazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWFza0NodW5rcyA9IFtdLCB0cmFuc2xhdGlvbiwgcGF0dGVybiwgb3B0aW9uYWwsIHJlY3Vyc2l2ZSwgb1JlY3Vyc2l2ZSwgcjtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hc2subGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvbiA9IGpNYXNrLnRyYW5zbGF0aW9uW21hc2suY2hhckF0KGkpXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0aW9uKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gdHJhbnNsYXRpb24ucGF0dGVybi50b1N0cmluZygpLnJlcGxhY2UoLy57MX0kfF4uezF9L2csICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWwgPSB0cmFuc2xhdGlvbi5vcHRpb25hbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlID0gdHJhbnNsYXRpb24ucmVjdXJzaXZlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY3Vyc2l2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFza0NodW5rcy5wdXNoKG1hc2suY2hhckF0KGkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9SZWN1cnNpdmUgPSB7ZGlnaXQ6IG1hc2suY2hhckF0KGkpLCBwYXR0ZXJuOiBwYXR0ZXJufTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tDaHVua3MucHVzaCghb3B0aW9uYWwgJiYgIXJlY3Vyc2l2ZSA/IHBhdHRlcm4gOiAocGF0dGVybiArICc/JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tDaHVua3MucHVzaChtYXNrLmNoYXJBdChpKS5yZXBsYWNlKC9bLVxcL1xcXFxeJCorPy4oKXxbXFxde31dL2csICdcXFxcJCYnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHIgPSBtYXNrQ2h1bmtzLmpvaW4oJycpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChvUmVjdXJzaXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IHIucmVwbGFjZShuZXcgUmVnRXhwKCcoJyArIG9SZWN1cnNpdmUuZGlnaXQgKyAnKC4qJyArIG9SZWN1cnNpdmUuZGlnaXQgKyAnKT8pJyksICcoJDEpPycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShuZXcgUmVnRXhwKG9SZWN1cnNpdmUuZGlnaXQsICdnJyksIG9SZWN1cnNpdmUucGF0dGVybik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAocik7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlc3Ryb3lFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZWwub2ZmKFsnaW5wdXQnLCAna2V5ZG93bicsICdrZXl1cCcsICdwYXN0ZScsICdkcm9wJywgJ2JsdXInLCAnZm9jdXNvdXQnLCAnJ10uam9pbignLm1hc2sgJykpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB2YWw6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpc0lucHV0ID0gZWwuaXMoJ2lucHV0JyksXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gaXNJbnB1dCA/ICd2YWwnIDogJ3RleHQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsW21ldGhvZF0oKSAhPT0gdikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbFttZXRob2RdKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByID0gZWw7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHIgPSBlbFttZXRob2RdKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHI7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNhbGN1bGF0ZUNhcmV0UG9zaXRpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9sZFZhbCA9IGVsLmRhdGEoJ21hc2stcHJldml1cy12YWx1ZScpIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbCA9IHAuZ2V0TWFza2VkKCksXHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZXRQb3NOZXcgPSBwLmdldENhcmV0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkVmFsICE9PSBuZXdWYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZXRQb3NPbGQgPSBlbC5kYXRhKCdtYXNrLXByZXZpdXMtY2FyZXQtcG9zJykgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsTCA9IG5ld1ZhbC5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZFZhbEwgPSBvbGRWYWwubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRzQmVmb3JlQ2FyZXQgPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRzQWZ0ZXJDYXJldCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tEaWdpdHNCZWZvcmVDYXJldEFsbCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tEaWdpdHNCZWZvcmVDYXJldEFsbE9sZCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBjYXJldFBvc05ldzsgaSA8IG5ld1ZhbEw7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXAubWFza0RpZ2l0UG9zTWFwW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRzQWZ0ZXJDYXJldCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gY2FyZXRQb3NOZXcgLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXAubWFza0RpZ2l0UG9zTWFwW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRzQmVmb3JlQ2FyZXQrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IGNhcmV0UG9zTmV3IC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAubWFza0RpZ2l0UG9zTWFwW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRzQmVmb3JlQ2FyZXRBbGwrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gY2FyZXRQb3NPbGQgLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocC5tYXNrRGlnaXRQb3NNYXBPbGRbaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tEaWdpdHNCZWZvcmVDYXJldEFsbE9sZCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgY3Vyc29yIGlzIGF0IHRoZSBlbmQga2VlcCBpdCB0aGVyZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjYXJldFBvc05ldyA+IG9sZFZhbEwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGNhcmV0UG9zTmV3ID0gbmV3VmFsTCAqIDEwO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2FyZXRQb3NPbGQgPj0gY2FyZXRQb3NOZXcgJiYgY2FyZXRQb3NPbGQgIT09IG9sZFZhbEwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwLm1hc2tEaWdpdFBvc01hcE9sZFtjYXJldFBvc05ld10pICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmV0UG9zID0gY2FyZXRQb3NOZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZXRQb3NOZXcgLT0gbWFza0RpZ2l0c0JlZm9yZUNhcmV0QWxsT2xkIC0gbWFza0RpZ2l0c0JlZm9yZUNhcmV0QWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmV0UG9zTmV3IC09IG1hc2tEaWdpdHNCZWZvcmVDYXJldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocC5tYXNrRGlnaXRQb3NNYXBbY2FyZXRQb3NOZXddKSAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZXRQb3NOZXcgPSBjYXJldFBvcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY2FyZXRQb3NOZXcgPiBjYXJldFBvc09sZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJldFBvc05ldyArPSBtYXNrRGlnaXRzQmVmb3JlQ2FyZXRBbGwgLSBtYXNrRGlnaXRzQmVmb3JlQ2FyZXRBbGxPbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmV0UG9zTmV3ICs9IG1hc2tEaWdpdHNBZnRlckNhcmV0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBjYXJldFBvc05ldztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYmVoYXZpb3VyOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XHJcbiAgICAgICAgICAgICAgICBwLmludmFsaWQgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGVsLmRhdGEoJ21hc2sta2V5Y29kZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoa2V5Q29kZSwgak1hc2suYnlQYXNzS2V5cykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1ZhbCA9IHAuZ2V0TWFza2VkKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmV0UG9zID0gcC5nZXRDYXJldCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIGEgY29tcGVuc2F0aW9uIHRvIGRldmljZXMvYnJvd3NlcnMgdGhhdCBkb24ndCBjb21wZW5zYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2FyZXQgcG9zaXRpb25pbmcgdGhlIHJpZ2h0IHdheVxyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBwLnNldENhcmV0KHAuY2FsY3VsYXRlQ2FyZXRQb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAkLmpNYXNrR2xvYmFscy5rZXlTdHJva2VDb21wZW5zYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBwLnZhbChuZXdWYWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHAuc2V0Q2FyZXQoY2FyZXRQb3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwLmNhbGxiYWNrcyhlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZ2V0TWFza2VkOiBmdW5jdGlvbihza2lwTWFza0NoYXJzLCB2YWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBidWYgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbCA9PT0gdW5kZWZpbmVkID8gcC52YWwoKSA6IHZhbCArICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIG0gPSAwLCBtYXNrTGVuID0gbWFzay5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgdiA9IDAsIHZhbExlbiA9IHZhbHVlLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAxLCBhZGRNZXRob2QgPSAncHVzaCcsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzZXRQb3MgPSAtMSxcclxuICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRDb3VudCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgbWFza0RpZ2l0UG9zQXJyID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE1hc2tDaGFyLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnJldmVyc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGRNZXRob2QgPSAndW5zaGlmdCc7XHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE1hc2tDaGFyID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBtID0gbWFza0xlbiAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgdiA9IHZhbExlbiAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtID4gLTEgJiYgdiA+IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RNYXNrQ2hhciA9IG1hc2tMZW4gLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbSA8IG1hc2tMZW4gJiYgdiA8IHZhbExlbjtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBsYXN0VW50cmFuc2xhdGVkTWFza0NoYXI7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoY2hlY2soKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXNrRGlnaXQgPSBtYXNrLmNoYXJBdChtKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsRGlnaXQgPSB2YWx1ZS5jaGFyQXQodiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uID0gak1hc2sudHJhbnNsYXRpb25bbWFza0RpZ2l0XTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxEaWdpdC5tYXRjaCh0cmFuc2xhdGlvbi5wYXR0ZXJuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmW2FkZE1ldGhvZF0odmFsRGlnaXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmFuc2xhdGlvbi5yZWN1cnNpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXRQb3MgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0UG9zID0gbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG0gPT09IGxhc3RNYXNrQ2hhciAmJiBtICE9PSByZXNldFBvcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gcmVzZXRQb3MgLSBvZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdE1hc2tDaGFyID09PSByZXNldFBvcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtIC09IG9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtICs9IG9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWxEaWdpdCA9PT0gbGFzdFVudHJhbnNsYXRlZE1hc2tDaGFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXRjaGVkIHRoZSBsYXN0IHVudHJhbnNsYXRlZCAocmF3KSBtYXNrIGNoYXJhY3RlciB0aGF0IHdlIGVuY291bnRlcmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsaWtlbHkgYW4gaW5zZXJ0IG9mZnNldCB0aGUgbWFzayBjaGFyYWN0ZXIgZnJvbSB0aGUgbGFzdCBlbnRyeTsgZmFsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhyb3VnaCBhbmQgb25seSBpbmNyZW1lbnQgdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFza0RpZ2l0Q291bnQtLTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RVbnRyYW5zbGF0ZWRNYXNrQ2hhciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2xhdGlvbi5vcHRpb25hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbSArPSBvZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2IC09IG9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2xhdGlvbi5mYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmW2FkZE1ldGhvZF0odHJhbnNsYXRpb24uZmFsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbSArPSBvZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2IC09IG9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBwLmludmFsaWQucHVzaCh7cDogdiwgdjogdmFsRGlnaXQsIGU6IHRyYW5zbGF0aW9uLnBhdHRlcm59KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2ICs9IG9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNraXBNYXNrQ2hhcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZlthZGRNZXRob2RdKG1hc2tEaWdpdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxEaWdpdCA9PT0gbWFza0RpZ2l0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXNrRGlnaXRQb3NBcnIucHVzaCh2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgKz0gb2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFVudHJhbnNsYXRlZE1hc2tDaGFyID0gbWFza0RpZ2l0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFza0RpZ2l0UG9zQXJyLnB1c2godiArIG1hc2tEaWdpdENvdW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tEaWdpdENvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG0gKz0gb2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbGFzdE1hc2tDaGFyRGlnaXQgPSBtYXNrLmNoYXJBdChsYXN0TWFza0NoYXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2tMZW4gPT09IHZhbExlbiArIDEgJiYgIWpNYXNrLnRyYW5zbGF0aW9uW2xhc3RNYXNrQ2hhckRpZ2l0XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1Zi5wdXNoKGxhc3RNYXNrQ2hhckRpZ2l0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsID0gYnVmLmpvaW4oJycpO1xyXG4gICAgICAgICAgICAgICAgcC5tYXBNYXNrZGlnaXRQb3NpdGlvbnMobmV3VmFsLCBtYXNrRGlnaXRQb3NBcnIsIHZhbExlbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3VmFsO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtYXBNYXNrZGlnaXRQb3NpdGlvbnM6IGZ1bmN0aW9uKG5ld1ZhbCwgbWFza0RpZ2l0UG9zQXJyLCB2YWxMZW4pIHtcclxuICAgICAgICAgICAgICB2YXIgbWFza0RpZmYgPSBvcHRpb25zLnJldmVyc2UgPyBuZXdWYWwubGVuZ3RoIC0gdmFsTGVuIDogMDtcclxuICAgICAgICAgICAgICBwLm1hc2tEaWdpdFBvc01hcCA9IHt9O1xyXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFza0RpZ2l0UG9zQXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwLm1hc2tEaWdpdFBvc01hcFttYXNrRGlnaXRQb3NBcnJbaV0gKyBtYXNrRGlmZl0gPSAxO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2FsbGJhY2tzOiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbCA9IHAudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IHZhbCAhPT0gb2xkVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdEFyZ3MgPSBbdmFsLCBlLCBlbCwgb3B0aW9uc10sXHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBmdW5jdGlvbihuYW1lLCBjcml0ZXJpYSwgYXJncykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnNbbmFtZV0gPT09ICdmdW5jdGlvbicgJiYgY3JpdGVyaWEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNbbmFtZV0uYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCdvbkNoYW5nZScsIGNoYW5nZWQgPT09IHRydWUsIGRlZmF1bHRBcmdzKTtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCdvbktleVByZXNzJywgY2hhbmdlZCA9PT0gdHJ1ZSwgZGVmYXVsdEFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soJ29uQ29tcGxldGUnLCB2YWwubGVuZ3RoID09PSBtYXNrLmxlbmd0aCwgZGVmYXVsdEFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soJ29uSW52YWxpZCcsIHAuaW52YWxpZC5sZW5ndGggPiAwLCBbdmFsLCBlLCBlbCwgcC5pbnZhbGlkLCBvcHRpb25zXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBlbCA9ICQoZWwpO1xyXG4gICAgICAgIHZhciBqTWFzayA9IHRoaXMsIG9sZFZhbHVlID0gcC52YWwoKSwgcmVnZXhNYXNrO1xyXG5cclxuICAgICAgICBtYXNrID0gdHlwZW9mIG1hc2sgPT09ICdmdW5jdGlvbicgPyBtYXNrKHAudmFsKCksIHVuZGVmaW5lZCwgZWwsICBvcHRpb25zKSA6IG1hc2s7XHJcblxyXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXHJcbiAgICAgICAgak1hc2subWFzayA9IG1hc2s7XHJcbiAgICAgICAgak1hc2sub3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICAgICAgak1hc2sucmVtb3ZlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjYXJldCA9IHAuZ2V0Q2FyZXQoKTtcclxuICAgICAgICAgICAgaWYgKGpNYXNrLm9wdGlvbnMucGxhY2Vob2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIGVsLnJlbW92ZUF0dHIoJ3BsYWNlaG9sZGVyJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVsLmRhdGEoJ21hc2stbWF4bGVuZ3RoJykpIHtcclxuICAgICAgICAgICAgICAgIGVsLnJlbW92ZUF0dHIoJ21heGxlbmd0aCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHAuZGVzdHJveUV2ZW50cygpO1xyXG4gICAgICAgICAgICBwLnZhbChqTWFzay5nZXRDbGVhblZhbCgpKTtcclxuICAgICAgICAgICAgcC5zZXRDYXJldChjYXJldCk7XHJcbiAgICAgICAgICAgIHJldHVybiBlbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBnZXQgdmFsdWUgd2l0aG91dCBtYXNrXHJcbiAgICAgICAgak1hc2suZ2V0Q2xlYW5WYWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICByZXR1cm4gcC5nZXRNYXNrZWQodHJ1ZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gZ2V0IG1hc2tlZCB2YWx1ZSB3aXRob3V0IHRoZSB2YWx1ZSBiZWluZyBpbiB0aGUgaW5wdXQgb3IgZWxlbWVudFxyXG4gICAgICAgIGpNYXNrLmdldE1hc2tlZFZhbCA9IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgIHJldHVybiBwLmdldE1hc2tlZChmYWxzZSwgdmFsKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgIGpNYXNrLmluaXQgPSBmdW5jdGlvbihvbmx5TWFzaykge1xyXG4gICAgICAgICAgICBvbmx5TWFzayA9IG9ubHlNYXNrIHx8IGZhbHNlO1xyXG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHJcbiAgICAgICAgICAgIGpNYXNrLmNsZWFySWZOb3RNYXRjaCAgPSAkLmpNYXNrR2xvYmFscy5jbGVhcklmTm90TWF0Y2g7XHJcbiAgICAgICAgICAgIGpNYXNrLmJ5UGFzc0tleXMgICAgICAgPSAkLmpNYXNrR2xvYmFscy5ieVBhc3NLZXlzO1xyXG4gICAgICAgICAgICBqTWFzay50cmFuc2xhdGlvbiAgICAgID0gJC5leHRlbmQoe30sICQuak1hc2tHbG9iYWxzLnRyYW5zbGF0aW9uLCBvcHRpb25zLnRyYW5zbGF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIGpNYXNrID0gJC5leHRlbmQodHJ1ZSwge30sIGpNYXNrLCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgICAgIHJlZ2V4TWFzayA9IHAuZ2V0UmVnZXhNYXNrKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAob25seU1hc2spIHtcclxuICAgICAgICAgICAgICAgIHAuZXZlbnRzKCk7XHJcbiAgICAgICAgICAgICAgICBwLnZhbChwLmdldE1hc2tlZCgpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnBsYWNlaG9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuYXR0cigncGxhY2Vob2xkZXInICwgb3B0aW9ucy5wbGFjZWhvbGRlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBpcyBuZWNlc3NhcnksIG90aGVyd2lzZSBpZiB0aGUgdXNlciBzdWJtaXQgdGhlIGZvcm1cclxuICAgICAgICAgICAgICAgIC8vIGFuZCB0aGVuIHByZXNzIHRoZSBcImJhY2tcIiBidXR0b24sIHRoZSBhdXRvY29tcGxldGUgd2lsbCBlcmFzZVxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIGRhdGEuIFdvcmtzIGZpbmUgb24gSUU5KywgRkYsIE9wZXJhLCBTYWZhcmkuXHJcbiAgICAgICAgICAgICAgICBpZiAoZWwuZGF0YSgnbWFzaycpKSB7XHJcbiAgICAgICAgICAgICAgICAgIGVsLmF0dHIoJ2F1dG9jb21wbGV0ZScsICdvZmYnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBkZXRlY3QgaWYgaXMgbmVjZXNzYXJ5IGxldCB0aGUgdXNlciB0eXBlIGZyZWVseS5cclxuICAgICAgICAgICAgICAgIC8vIGZvciBpcyBhIGxvdCBmYXN0ZXIgdGhhbiBmb3JFYWNoLlxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG1heGxlbmd0aCA9IHRydWU7IGkgPCBtYXNrLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0aW9uID0gak1hc2sudHJhbnNsYXRpb25bbWFzay5jaGFyQXQoaSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0cmFuc2xhdGlvbiAmJiB0cmFuc2xhdGlvbi5yZWN1cnNpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4bGVuZ3RoID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobWF4bGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuYXR0cignbWF4bGVuZ3RoJywgbWFzay5sZW5ndGgpLmRhdGEoJ21hc2stbWF4bGVuZ3RoJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcC5kZXN0cm95RXZlbnRzKCk7XHJcbiAgICAgICAgICAgICAgICBwLmV2ZW50cygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYXJldCA9IHAuZ2V0Q2FyZXQoKTtcclxuICAgICAgICAgICAgICAgIHAudmFsKHAuZ2V0TWFza2VkKCkpO1xyXG4gICAgICAgICAgICAgICAgcC5zZXRDYXJldChjYXJldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBqTWFzay5pbml0KCFlbC5pcygnaW5wdXQnKSk7XHJcbiAgICB9O1xyXG5cclxuICAgICQubWFza1dhdGNoZXJzID0ge307XHJcbiAgICB2YXIgSFRNTEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGlucHV0ID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgb3B0aW9ucyA9IHt9LFxyXG4gICAgICAgICAgICBwcmVmaXggPSAnZGF0YS1tYXNrLScsXHJcbiAgICAgICAgICAgIG1hc2sgPSBpbnB1dC5hdHRyKCdkYXRhLW1hc2snKTtcclxuXHJcbiAgICAgICAgaWYgKGlucHV0LmF0dHIocHJlZml4ICsgJ3JldmVyc2UnKSkge1xyXG4gICAgICAgICAgICBvcHRpb25zLnJldmVyc2UgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGlucHV0LmF0dHIocHJlZml4ICsgJ2NsZWFyaWZub3RtYXRjaCcpKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuY2xlYXJJZk5vdE1hdGNoID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChpbnB1dC5hdHRyKHByZWZpeCArICdzZWxlY3RvbmZvY3VzJykgPT09ICd0cnVlJykge1xyXG4gICAgICAgICAgIG9wdGlvbnMuc2VsZWN0T25Gb2N1cyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobm90U2FtZU1hc2tPYmplY3QoaW5wdXQsIG1hc2ssIG9wdGlvbnMpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5kYXRhKCdtYXNrJywgbmV3IE1hc2sodGhpcywgbWFzaywgb3B0aW9ucykpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBub3RTYW1lTWFza09iamVjdCA9IGZ1bmN0aW9uKGZpZWxkLCBtYXNrLCBvcHRpb25zKSB7XHJcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgdmFyIG1hc2tPYmplY3QgPSAkKGZpZWxkKS5kYXRhKCdtYXNrJyksXHJcbiAgICAgICAgICAgIHN0cmluZ2lmeSA9IEpTT04uc3RyaW5naWZ5LFxyXG4gICAgICAgICAgICB2YWx1ZSA9ICQoZmllbGQpLnZhbCgpIHx8ICQoZmllbGQpLnRleHQoKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIG1hc2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIG1hc2sgPSBtYXNrKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIG1hc2tPYmplY3QgIT09ICdvYmplY3QnIHx8IHN0cmluZ2lmeShtYXNrT2JqZWN0Lm9wdGlvbnMpICE9PSBzdHJpbmdpZnkob3B0aW9ucykgfHwgbWFza09iamVjdC5tYXNrICE9PSBtYXNrO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XHJcbiAgICB9LFxyXG4gICAgZXZlbnRTdXBwb3J0ZWQgPSBmdW5jdGlvbihldmVudE5hbWUpIHtcclxuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwgaXNTdXBwb3J0ZWQ7XHJcblxyXG4gICAgICAgIGV2ZW50TmFtZSA9ICdvbicgKyBldmVudE5hbWU7XHJcbiAgICAgICAgaXNTdXBwb3J0ZWQgPSAoZXZlbnROYW1lIGluIGVsKTtcclxuXHJcbiAgICAgICAgaWYgKCAhaXNTdXBwb3J0ZWQgKSB7XHJcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShldmVudE5hbWUsICdyZXR1cm47Jyk7XHJcbiAgICAgICAgICAgIGlzU3VwcG9ydGVkID0gdHlwZW9mIGVsW2V2ZW50TmFtZV0gPT09ICdmdW5jdGlvbic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsID0gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGlzU3VwcG9ydGVkO1xyXG4gICAgfTtcclxuXHJcbiAgICAkLmZuLm1hc2sgPSBmdW5jdGlvbihtYXNrLCBvcHRpb25zKSB7XHJcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gdGhpcy5zZWxlY3RvcixcclxuICAgICAgICAgICAgZ2xvYmFscyA9ICQuak1hc2tHbG9iYWxzLFxyXG4gICAgICAgICAgICBpbnRlcnZhbCA9IGdsb2JhbHMud2F0Y2hJbnRlcnZhbCxcclxuICAgICAgICAgICAgd2F0Y2hJbnB1dHMgPSBvcHRpb25zLndhdGNoSW5wdXRzIHx8IGdsb2JhbHMud2F0Y2hJbnB1dHMsXHJcbiAgICAgICAgICAgIG1hc2tGdW5jdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vdFNhbWVNYXNrT2JqZWN0KHRoaXMsIG1hc2ssIG9wdGlvbnMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQodGhpcykuZGF0YSgnbWFzaycsIG5ldyBNYXNrKHRoaXMsIG1hc2ssIG9wdGlvbnMpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJCh0aGlzKS5lYWNoKG1hc2tGdW5jdGlvbik7XHJcblxyXG4gICAgICAgIGlmIChzZWxlY3RvciAmJiBzZWxlY3RvciAhPT0gJycgJiYgd2F0Y2hJbnB1dHMpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCgkLm1hc2tXYXRjaGVyc1tzZWxlY3Rvcl0pO1xyXG4gICAgICAgICAgICAkLm1hc2tXYXRjaGVyc1tzZWxlY3Rvcl0gPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkuZmluZChzZWxlY3RvcikuZWFjaChtYXNrRnVuY3Rpb24pO1xyXG4gICAgICAgICAgICB9LCBpbnRlcnZhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuXHJcbiAgICAkLmZuLm1hc2tlZCA9IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEoJ21hc2snKS5nZXRNYXNrZWRWYWwodmFsKTtcclxuICAgIH07XHJcblxyXG4gICAgJC5mbi51bm1hc2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKCQubWFza1dhdGNoZXJzW3RoaXMuc2VsZWN0b3JdKTtcclxuICAgICAgICBkZWxldGUgJC5tYXNrV2F0Y2hlcnNbdGhpcy5zZWxlY3Rvcl07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGFNYXNrID0gJCh0aGlzKS5kYXRhKCdtYXNrJyk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhTWFzaykge1xyXG4gICAgICAgICAgICAgICAgZGF0YU1hc2sucmVtb3ZlKCkucmVtb3ZlRGF0YSgnbWFzaycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICQuZm4uY2xlYW5WYWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhKCdtYXNrJykuZ2V0Q2xlYW5WYWwoKTtcclxuICAgIH07XHJcblxyXG4gICAgJC5hcHBseURhdGFNYXNrID0gZnVuY3Rpb24oc2VsZWN0b3IpIHtcclxuICAgICAgICBzZWxlY3RvciA9IHNlbGVjdG9yIHx8ICQuak1hc2tHbG9iYWxzLm1hc2tFbGVtZW50cztcclxuICAgICAgICB2YXIgJHNlbGVjdG9yID0gKHNlbGVjdG9yIGluc3RhbmNlb2YgJCkgPyBzZWxlY3RvciA6ICQoc2VsZWN0b3IpO1xyXG4gICAgICAgICRzZWxlY3Rvci5maWx0ZXIoJC5qTWFza0dsb2JhbHMuZGF0YU1hc2tBdHRyKS5lYWNoKEhUTUxBdHRyaWJ1dGVzKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGdsb2JhbHMgPSB7XHJcbiAgICAgICAgbWFza0VsZW1lbnRzOiAnaW5wdXQsdGQsc3BhbixkaXYnLFxyXG4gICAgICAgIGRhdGFNYXNrQXR0cjogJypbZGF0YS1tYXNrXScsXHJcbiAgICAgICAgZGF0YU1hc2s6IHRydWUsXHJcbiAgICAgICAgd2F0Y2hJbnRlcnZhbDogMzAwLFxyXG4gICAgICAgIHdhdGNoSW5wdXRzOiB0cnVlLFxyXG4gICAgICAgIGtleVN0cm9rZUNvbXBlbnNhdGlvbjogMTAsXHJcbiAgICAgICAgLy8gb2xkIHZlcnNpb25zIG9mIGNocm9tZSBkb250IHdvcmsgZ3JlYXQgd2l0aCBpbnB1dCBldmVudFxyXG4gICAgICAgIHVzZUlucHV0OiAhL0Nocm9tZVxcL1syLTRdWzAtOV18U2Ftc3VuZ0Jyb3dzZXIvLnRlc3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpICYmIGV2ZW50U3VwcG9ydGVkKCdpbnB1dCcpLFxyXG4gICAgICAgIHdhdGNoRGF0YU1hc2s6IGZhbHNlLFxyXG4gICAgICAgIGJ5UGFzc0tleXM6IFs5LCAxNiwgMTcsIDE4LCAzNiwgMzcsIDM4LCAzOSwgNDAsIDkxXSxcclxuICAgICAgICB0cmFuc2xhdGlvbjoge1xyXG4gICAgICAgICAgICAnMCc6IHtwYXR0ZXJuOiAvXFxkL30sXHJcbiAgICAgICAgICAgICc5Jzoge3BhdHRlcm46IC9cXGQvLCBvcHRpb25hbDogdHJ1ZX0sXHJcbiAgICAgICAgICAgICcjJzoge3BhdHRlcm46IC9cXGQvLCByZWN1cnNpdmU6IHRydWV9LFxyXG4gICAgICAgICAgICAnQSc6IHtwYXR0ZXJuOiAvW2EtekEtWjAtOV0vfSxcclxuICAgICAgICAgICAgJ1MnOiB7cGF0dGVybjogL1thLXpBLVpdL31cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICQuak1hc2tHbG9iYWxzID0gJC5qTWFza0dsb2JhbHMgfHwge307XHJcbiAgICBnbG9iYWxzID0gJC5qTWFza0dsb2JhbHMgPSAkLmV4dGVuZCh0cnVlLCB7fSwgZ2xvYmFscywgJC5qTWFza0dsb2JhbHMpO1xyXG5cclxuICAgIC8vIGxvb2tpbmcgZm9yIGlucHV0cyB3aXRoIGRhdGEtbWFzayBhdHRyaWJ1dGVcclxuICAgIGlmIChnbG9iYWxzLmRhdGFNYXNrKSB7XHJcbiAgICAgICAgJC5hcHBseURhdGFNYXNrKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCQuak1hc2tHbG9iYWxzLndhdGNoRGF0YU1hc2spIHtcclxuICAgICAgICAgICAgJC5hcHBseURhdGFNYXNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgZ2xvYmFscy53YXRjaEludGVydmFsKTtcclxufSwgd2luZG93LmpRdWVyeSwgd2luZG93LlplcHRvKSk7Il19
