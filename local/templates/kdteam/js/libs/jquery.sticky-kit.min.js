(function(){var t,i;t=this.jQuery||window.jQuery,i=t(window),t.fn.stick_in_parent=function(o){var s,e,n,r,c,l,a,f,p,u,d,h;for(null==o&&(o={}),h=o.sticky_class,l=o.inner_scrolling,d=o.recalc_every,u=o.parent,p=o.offset_top,f=o.spacer,n=o.bottoming,null==p&&(p=80),null==u&&(u=void 0),null==l&&(l=!0),null==h&&(h="is_stuck"),s=t(document),null==n&&(n=!0),r=function(o,e,r,c,a,g,k,m){var v,y,_,b,w,x,C,I,z,A,j,M;if(!o.data("sticky_kit")){if(o.data("sticky_kit",!0),w=s.height(),C=o.parent(),null!=u&&(C=C.closest(u)),!C.length)throw"failed to find stick parent";if(_=!1,v=!1,j=null!=f?f&&o.closest(f):t("<div />"),j&&j.css("position",o.css("position")),I=function(){var t,i,n;if(!m)return w=s.height(),t=parseInt(C.css("border-top-width"),10),i=parseInt(C.css("padding-top"),10),e=parseInt(C.css("padding-bottom"),10),r=C.offset().top+t+i,c=C.height(),_&&(_=!1,v=!1,null==f&&(o.insertAfter(j),j.detach()),o.css({position:"",top:"",width:"",bottom:""}).removeClass(h),n=!0),a=o.offset().top-(parseInt(o.css("margin-top"),10)||0)-p,g=o.outerHeight(!0),k=o.css("float"),j&&j.css({width:o.outerWidth(!0),height:g,display:o.css("display"),"vertical-align":o.css("vertical-align"),"float":k}),n?M():void 0},I(),g!==c)return b=void 0,x=p,A=d,M=function(){var t,u,y,z,M,Q;if(!m)return y=!1,null!=A&&(A-=1,A<=0&&(A=d,I(),y=!0)),y||s.height()===w||(I(),y=!0),z=i.scrollTop(),null!=b&&(u=z-b),b=z,_?(n&&(M=z+g+x>c+r,v&&!M&&(v=!1,o.css({position:"fixed",bottom:"",top:x}).trigger("sticky_kit:unbottom"))),z<a&&(_=!1,x=p,null==f&&("left"!==k&&"right"!==k||o.insertAfter(j),j.detach()),t={position:"",width:"",top:""},o.css(t).removeClass(h).trigger("sticky_kit:unstick")),l&&(Q=i.height(),g+p>Q&&(v||(x-=u,x=Math.max(Q-g,x),x=Math.min(p,x),_&&o.css({top:x+"px"}))))):z>a&&(_=!0,t={position:"fixed",top:x},t.width="border-box"===o.css("box-sizing")?o.outerWidth()+"px":o.width()+"px",o.css(t).addClass(h),null==f&&(o.after(j),"left"!==k&&"right"!==k||j.append(o)),o.trigger("sticky_kit:stick")),_&&n&&(null==M&&(M=z+g+x>c+r),!v&&M)?(v=!0,"static"===C.css("position")&&C.css({position:"relative"}),o.css({position:"absolute",bottom:e,top:"auto"}).trigger("sticky_kit:bottom")):void 0},z=function(){return I(),M()},y=function(){if(m=!0,i.off("touchmove",M),i.off("scroll",M),i.off("resize",z),t(document.body).off("sticky_kit:recalc",z),o.off("sticky_kit:detach",y),o.removeData("sticky_kit"),o.css({position:"",bottom:"",top:"",width:""}),C.position("position",""),_)return null==f&&("left"!==k&&"right"!==k||o.insertAfter(j),j.remove()),o.removeClass(h)},i.on("touchmove",M),i.on("scroll",M),i.on("resize",z),t(document.body).on("sticky_kit:recalc",z),o.on("sticky_kit:detach",y),setTimeout(M,0)}},c=0,a=this.length;c<a;c++)e=this[c],r(t(e));return this}}).call(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnMvanF1ZXJ5LnN0aWNreS1raXQubWluLmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW4iLCJ0aGlzIiwialF1ZXJ5Iiwid2luZG93IiwiZm4iLCJzdGlja19pbl9wYXJlbnQiLCJvcHRzIiwiZG9jIiwiZWxtIiwiZW5hYmxlX2JvdHRvbWluZyIsImkiLCJpbm5lcl9zY3JvbGxpbmciLCJsZW4iLCJtYW51YWxfc3BhY2VyIiwib2Zmc2V0X3RvcCIsInBhcmVudF9zZWxlY3RvciIsInJlY2FsY19ldmVyeSIsInN0aWNreV9jbGFzcyIsInBhcmVudCIsInNwYWNlciIsImJvdHRvbWluZyIsImRvY3VtZW50IiwicGFkZGluZ19ib3R0b20iLCJwYXJlbnRfdG9wIiwicGFyZW50X2hlaWdodCIsInRvcCIsImhlaWdodCIsImVsX2Zsb2F0IiwiZGV0YWNoZWQiLCJib3R0b21lZCIsImRldGFjaCIsImZpeGVkIiwibGFzdF9wb3MiLCJsYXN0X3Njcm9sbF9oZWlnaHQiLCJvZmZzZXQiLCJyZWNhbGMiLCJyZWNhbGNfYW5kX3RpY2siLCJyZWNhbGNfY291bnRlciIsInRpY2siLCJkYXRhIiwiY2xvc2VzdCIsImxlbmd0aCIsImNzcyIsImJvcmRlcl90b3AiLCJwYWRkaW5nX3RvcCIsInJlc3RvcmUiLCJwYXJzZUludCIsImluc2VydEFmdGVyIiwicG9zaXRpb24iLCJ3aWR0aCIsImJvdHRvbSIsInJlbW92ZUNsYXNzIiwib3V0ZXJIZWlnaHQiLCJvdXRlcldpZHRoIiwiZGlzcGxheSIsInZlcnRpY2FsLWFsaWduIiwiZmxvYXQiLCJkZWx0YSIsInJlY2FsY2VkIiwic2Nyb2xsIiwid2lsbF9ib3R0b20iLCJ3aW5faGVpZ2h0Iiwic2Nyb2xsVG9wIiwidHJpZ2dlciIsIk1hdGgiLCJtYXgiLCJtaW4iLCJhZGRDbGFzcyIsImFmdGVyIiwiYXBwZW5kIiwib2ZmIiwiYm9keSIsInJlbW92ZURhdGEiLCJyZW1vdmUiLCJvbiIsInNldFRpbWVvdXQiLCJjYWxsIl0sIm1hcHBp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LEVBQUdMLEVBQUVTLEdBRVAsT0FBT1AsU0FHUjJFLEtBQUszRSIsImZpbGUiOiJsaWJzL2pxdWVyeS5zdGlja3kta2l0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS45LjJcclxuXHJcbi8qKlxyXG4gQGxpY2Vuc2UgU3RpY2t5LWtpdCB2MS4xLjIgfCBXVEZQTCB8IExlYWYgQ29yY29yYW4gMjAxNSB8IGh0dHA6Ly9sZWFmby5uZXRcclxuICovXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgdmFyICQsIHdpbjtcclxuXHJcbiAgJCA9IHRoaXMualF1ZXJ5IHx8IHdpbmRvdy5qUXVlcnk7XHJcblxyXG4gIHdpbiA9ICQod2luZG93KTtcclxuXHJcbiAgJC5mbi5zdGlja19pbl9wYXJlbnQgPSBmdW5jdGlvbihvcHRzKSB7XHJcbiAgICB2YXIgZG9jLCBlbG0sIGVuYWJsZV9ib3R0b21pbmcsIGZuLCBpLCBpbm5lcl9zY3JvbGxpbmcsIGxlbiwgbWFudWFsX3NwYWNlciwgb2Zmc2V0X3RvcCwgcGFyZW50X3NlbGVjdG9yLCByZWNhbGNfZXZlcnksIHN0aWNreV9jbGFzcztcclxuICAgIGlmIChvcHRzID09IG51bGwpIHtcclxuICAgICAgb3B0cyA9IHt9O1xyXG4gICAgfVxyXG4gICAgc3RpY2t5X2NsYXNzID0gb3B0cy5zdGlja3lfY2xhc3MsIGlubmVyX3Njcm9sbGluZyA9IG9wdHMuaW5uZXJfc2Nyb2xsaW5nLCByZWNhbGNfZXZlcnkgPSBvcHRzLnJlY2FsY19ldmVyeSwgcGFyZW50X3NlbGVjdG9yID0gb3B0cy5wYXJlbnQsIG9mZnNldF90b3AgPSBvcHRzLm9mZnNldF90b3AsIG1hbnVhbF9zcGFjZXIgPSBvcHRzLnNwYWNlciwgZW5hYmxlX2JvdHRvbWluZyA9IG9wdHMuYm90dG9taW5nO1xyXG4gICAgaWYgKG9mZnNldF90b3AgPT0gbnVsbCkge1xyXG4gICAgICBvZmZzZXRfdG9wID0gODA7XHJcbiAgICB9XHJcbiAgICBpZiAocGFyZW50X3NlbGVjdG9yID09IG51bGwpIHtcclxuICAgICAgcGFyZW50X3NlbGVjdG9yID0gdm9pZCAwO1xyXG4gICAgfVxyXG4gICAgaWYgKGlubmVyX3Njcm9sbGluZyA9PSBudWxsKSB7XHJcbiAgICAgIGlubmVyX3Njcm9sbGluZyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAoc3RpY2t5X2NsYXNzID09IG51bGwpIHtcclxuICAgICAgc3RpY2t5X2NsYXNzID0gXCJpc19zdHVja1wiO1xyXG4gICAgfVxyXG4gICAgZG9jID0gJChkb2N1bWVudCk7XHJcbiAgICBpZiAoZW5hYmxlX2JvdHRvbWluZyA9PSBudWxsKSB7XHJcbiAgICAgIGVuYWJsZV9ib3R0b21pbmcgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZm4gPSBmdW5jdGlvbihlbG0sIHBhZGRpbmdfYm90dG9tLCBwYXJlbnRfdG9wLCBwYXJlbnRfaGVpZ2h0LCB0b3AsIGhlaWdodCwgZWxfZmxvYXQsIGRldGFjaGVkKSB7XHJcbiAgICAgIHZhciBib3R0b21lZCwgZGV0YWNoLCBmaXhlZCwgbGFzdF9wb3MsIGxhc3Rfc2Nyb2xsX2hlaWdodCwgb2Zmc2V0LCBwYXJlbnQsIHJlY2FsYywgcmVjYWxjX2FuZF90aWNrLCByZWNhbGNfY291bnRlciwgc3BhY2VyLCB0aWNrO1xyXG4gICAgICBpZiAoZWxtLmRhdGEoXCJzdGlja3lfa2l0XCIpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGVsbS5kYXRhKFwic3RpY2t5X2tpdFwiLCB0cnVlKTtcclxuICAgICAgbGFzdF9zY3JvbGxfaGVpZ2h0ID0gZG9jLmhlaWdodCgpO1xyXG4gICAgICBwYXJlbnQgPSBlbG0ucGFyZW50KCk7XHJcbiAgICAgIGlmIChwYXJlbnRfc2VsZWN0b3IgIT0gbnVsbCkge1xyXG4gICAgICAgIHBhcmVudCA9IHBhcmVudC5jbG9zZXN0KHBhcmVudF9zZWxlY3Rvcik7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFwYXJlbnQubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhyb3cgXCJmYWlsZWQgdG8gZmluZCBzdGljayBwYXJlbnRcIjtcclxuICAgICAgfVxyXG4gICAgICBmaXhlZCA9IGZhbHNlO1xyXG4gICAgICBib3R0b21lZCA9IGZhbHNlO1xyXG4gICAgICBzcGFjZXIgPSBtYW51YWxfc3BhY2VyICE9IG51bGwgPyBtYW51YWxfc3BhY2VyICYmIGVsbS5jbG9zZXN0KG1hbnVhbF9zcGFjZXIpIDogJChcIjxkaXYgLz5cIik7XHJcbiAgICAgIGlmIChzcGFjZXIpIHtcclxuICAgICAgICBzcGFjZXIuY3NzKCdwb3NpdGlvbicsIGVsbS5jc3MoJ3Bvc2l0aW9uJykpO1xyXG4gICAgICB9XHJcbiAgICAgIHJlY2FsYyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBib3JkZXJfdG9wLCBwYWRkaW5nX3RvcCwgcmVzdG9yZTtcclxuICAgICAgICBpZiAoZGV0YWNoZWQpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdF9zY3JvbGxfaGVpZ2h0ID0gZG9jLmhlaWdodCgpO1xyXG4gICAgICAgIGJvcmRlcl90b3AgPSBwYXJzZUludChwYXJlbnQuY3NzKFwiYm9yZGVyLXRvcC13aWR0aFwiKSwgMTApO1xyXG4gICAgICAgIHBhZGRpbmdfdG9wID0gcGFyc2VJbnQocGFyZW50LmNzcyhcInBhZGRpbmctdG9wXCIpLCAxMCk7XHJcbiAgICAgICAgcGFkZGluZ19ib3R0b20gPSBwYXJzZUludChwYXJlbnQuY3NzKFwicGFkZGluZy1ib3R0b21cIiksIDEwKTtcclxuICAgICAgICBwYXJlbnRfdG9wID0gcGFyZW50Lm9mZnNldCgpLnRvcCArIGJvcmRlcl90b3AgKyBwYWRkaW5nX3RvcDtcclxuICAgICAgICBwYXJlbnRfaGVpZ2h0ID0gcGFyZW50LmhlaWdodCgpO1xyXG4gICAgICAgIGlmIChmaXhlZCkge1xyXG4gICAgICAgICAgZml4ZWQgPSBmYWxzZTtcclxuICAgICAgICAgIGJvdHRvbWVkID0gZmFsc2U7XHJcbiAgICAgICAgICBpZiAobWFudWFsX3NwYWNlciA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGVsbS5pbnNlcnRBZnRlcihzcGFjZXIpO1xyXG4gICAgICAgICAgICBzcGFjZXIuZGV0YWNoKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbG0uY3NzKHtcclxuICAgICAgICAgICAgcG9zaXRpb246IFwiXCIsXHJcbiAgICAgICAgICAgIHRvcDogXCJcIixcclxuICAgICAgICAgICAgd2lkdGg6IFwiXCIsXHJcbiAgICAgICAgICAgIGJvdHRvbTogXCJcIlxyXG4gICAgICAgICAgfSkucmVtb3ZlQ2xhc3Moc3RpY2t5X2NsYXNzKTtcclxuICAgICAgICAgIHJlc3RvcmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0b3AgPSBlbG0ub2Zmc2V0KCkudG9wIC0gKHBhcnNlSW50KGVsbS5jc3MoXCJtYXJnaW4tdG9wXCIpLCAxMCkgfHwgMCkgLSBvZmZzZXRfdG9wO1xyXG4gICAgICAgIGhlaWdodCA9IGVsbS5vdXRlckhlaWdodCh0cnVlKTtcclxuICAgICAgICBlbF9mbG9hdCA9IGVsbS5jc3MoXCJmbG9hdFwiKTtcclxuICAgICAgICBpZiAoc3BhY2VyKSB7XHJcbiAgICAgICAgICBzcGFjZXIuY3NzKHtcclxuICAgICAgICAgICAgd2lkdGg6IGVsbS5vdXRlcldpZHRoKHRydWUpLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcclxuICAgICAgICAgICAgZGlzcGxheTogZWxtLmNzcyhcImRpc3BsYXlcIiksXHJcbiAgICAgICAgICAgIFwidmVydGljYWwtYWxpZ25cIjogZWxtLmNzcyhcInZlcnRpY2FsLWFsaWduXCIpLFxyXG4gICAgICAgICAgICBcImZsb2F0XCI6IGVsX2Zsb2F0XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJlc3RvcmUpIHtcclxuICAgICAgICAgIHJldHVybiB0aWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICByZWNhbGMoKTtcclxuICAgICAgaWYgKGhlaWdodCA9PT0gcGFyZW50X2hlaWdodCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBsYXN0X3BvcyA9IHZvaWQgMDtcclxuICAgICAgb2Zmc2V0ID0gb2Zmc2V0X3RvcDtcclxuICAgICAgcmVjYWxjX2NvdW50ZXIgPSByZWNhbGNfZXZlcnk7XHJcbiAgICAgIHRpY2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY3NzLCBkZWx0YSwgcmVjYWxjZWQsIHNjcm9sbCwgd2lsbF9ib3R0b20sIHdpbl9oZWlnaHQ7XHJcbiAgICAgICAgaWYgKGRldGFjaGVkKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlY2FsY2VkID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHJlY2FsY19jb3VudGVyICE9IG51bGwpIHtcclxuICAgICAgICAgIHJlY2FsY19jb3VudGVyIC09IDE7XHJcbiAgICAgICAgICBpZiAocmVjYWxjX2NvdW50ZXIgPD0gMCkge1xyXG4gICAgICAgICAgICByZWNhbGNfY291bnRlciA9IHJlY2FsY19ldmVyeTtcclxuICAgICAgICAgICAgcmVjYWxjKCk7XHJcbiAgICAgICAgICAgIHJlY2FsY2VkID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFyZWNhbGNlZCAmJiBkb2MuaGVpZ2h0KCkgIT09IGxhc3Rfc2Nyb2xsX2hlaWdodCkge1xyXG4gICAgICAgICAgcmVjYWxjKCk7XHJcbiAgICAgICAgICByZWNhbGNlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNjcm9sbCA9IHdpbi5zY3JvbGxUb3AoKTtcclxuICAgICAgICBpZiAobGFzdF9wb3MgIT0gbnVsbCkge1xyXG4gICAgICAgICAgZGVsdGEgPSBzY3JvbGwgLSBsYXN0X3BvcztcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdF9wb3MgPSBzY3JvbGw7XHJcbiAgICAgICAgaWYgKGZpeGVkKSB7XHJcbiAgICAgICAgICBpZiAoZW5hYmxlX2JvdHRvbWluZykge1xyXG4gICAgICAgICAgICB3aWxsX2JvdHRvbSA9IHNjcm9sbCArIGhlaWdodCArIG9mZnNldCA+IHBhcmVudF9oZWlnaHQgKyBwYXJlbnRfdG9wO1xyXG4gICAgICAgICAgICBpZiAoYm90dG9tZWQgJiYgIXdpbGxfYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgYm90dG9tZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBlbG0uY3NzKHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcImZpeGVkXCIsXHJcbiAgICAgICAgICAgICAgICBib3R0b206IFwiXCIsXHJcbiAgICAgICAgICAgICAgICB0b3A6IG9mZnNldFxyXG4gICAgICAgICAgICAgIH0pLnRyaWdnZXIoXCJzdGlja3lfa2l0OnVuYm90dG9tXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoc2Nyb2xsIDwgdG9wKSB7XHJcbiAgICAgICAgICAgIGZpeGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldF90b3A7XHJcbiAgICAgICAgICAgIGlmIChtYW51YWxfc3BhY2VyID09IG51bGwpIHtcclxuICAgICAgICAgICAgICBpZiAoZWxfZmxvYXQgPT09IFwibGVmdFwiIHx8IGVsX2Zsb2F0ID09PSBcInJpZ2h0XCIpIHtcclxuICAgICAgICAgICAgICAgIGVsbS5pbnNlcnRBZnRlcihzcGFjZXIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBzcGFjZXIuZGV0YWNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY3NzID0ge1xyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBcIlwiLFxyXG4gICAgICAgICAgICAgIHdpZHRoOiBcIlwiLFxyXG4gICAgICAgICAgICAgIHRvcDogXCJcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBlbG0uY3NzKGNzcykucmVtb3ZlQ2xhc3Moc3RpY2t5X2NsYXNzKS50cmlnZ2VyKFwic3RpY2t5X2tpdDp1bnN0aWNrXCIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGlubmVyX3Njcm9sbGluZykge1xyXG4gICAgICAgICAgICB3aW5faGVpZ2h0ID0gd2luLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBpZiAoaGVpZ2h0ICsgb2Zmc2V0X3RvcCA+IHdpbl9oZWlnaHQpIHtcclxuICAgICAgICAgICAgICBpZiAoIWJvdHRvbWVkKSB7XHJcbiAgICAgICAgICAgICAgICBvZmZzZXQgLT0gZGVsdGE7XHJcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBNYXRoLm1heCh3aW5faGVpZ2h0IC0gaGVpZ2h0LCBvZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gTWF0aC5taW4ob2Zmc2V0X3RvcCwgb2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgIGlmIChmaXhlZCkge1xyXG4gICAgICAgICAgICAgICAgICBlbG0uY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICB0b3A6IG9mZnNldCArIFwicHhcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHNjcm9sbCA+IHRvcCkge1xyXG4gICAgICAgICAgICBmaXhlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGNzcyA9IHtcclxuICAgICAgICAgICAgICBwb3NpdGlvbjogXCJmaXhlZFwiLFxyXG4gICAgICAgICAgICAgIHRvcDogb2Zmc2V0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNzcy53aWR0aCA9IGVsbS5jc3MoXCJib3gtc2l6aW5nXCIpID09PSBcImJvcmRlci1ib3hcIiA/IGVsbS5vdXRlcldpZHRoKCkgKyBcInB4XCIgOiBlbG0ud2lkdGgoKSArIFwicHhcIjtcclxuICAgICAgICAgICAgZWxtLmNzcyhjc3MpLmFkZENsYXNzKHN0aWNreV9jbGFzcyk7XHJcbiAgICAgICAgICAgIGlmIChtYW51YWxfc3BhY2VyID09IG51bGwpIHtcclxuICAgICAgICAgICAgICBlbG0uYWZ0ZXIoc3BhY2VyKTtcclxuICAgICAgICAgICAgICBpZiAoZWxfZmxvYXQgPT09IFwibGVmdFwiIHx8IGVsX2Zsb2F0ID09PSBcInJpZ2h0XCIpIHtcclxuICAgICAgICAgICAgICAgIHNwYWNlci5hcHBlbmQoZWxtKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxtLnRyaWdnZXIoXCJzdGlja3lfa2l0OnN0aWNrXCIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZml4ZWQgJiYgZW5hYmxlX2JvdHRvbWluZykge1xyXG4gICAgICAgICAgaWYgKHdpbGxfYm90dG9tID09IG51bGwpIHtcclxuICAgICAgICAgICAgd2lsbF9ib3R0b20gPSBzY3JvbGwgKyBoZWlnaHQgKyBvZmZzZXQgPiBwYXJlbnRfaGVpZ2h0ICsgcGFyZW50X3RvcDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICghYm90dG9tZWQgJiYgd2lsbF9ib3R0b20pIHtcclxuICAgICAgICAgICAgYm90dG9tZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50LmNzcyhcInBvc2l0aW9uXCIpID09PSBcInN0YXRpY1wiKSB7XHJcbiAgICAgICAgICAgICAgcGFyZW50LmNzcyh7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVsbS5jc3Moe1xyXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXHJcbiAgICAgICAgICAgICAgYm90dG9tOiBwYWRkaW5nX2JvdHRvbSxcclxuICAgICAgICAgICAgICB0b3A6IFwiYXV0b1wiXHJcbiAgICAgICAgICAgIH0pLnRyaWdnZXIoXCJzdGlja3lfa2l0OmJvdHRvbVwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIHJlY2FsY19hbmRfdGljayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJlY2FsYygpO1xyXG4gICAgICAgIHJldHVybiB0aWNrKCk7XHJcbiAgICAgIH07XHJcbiAgICAgIGRldGFjaCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRldGFjaGVkID0gdHJ1ZTtcclxuICAgICAgICB3aW4ub2ZmKFwidG91Y2htb3ZlXCIsIHRpY2spO1xyXG4gICAgICAgIHdpbi5vZmYoXCJzY3JvbGxcIiwgdGljayk7XHJcbiAgICAgICAgd2luLm9mZihcInJlc2l6ZVwiLCByZWNhbGNfYW5kX3RpY2spO1xyXG4gICAgICAgICQoZG9jdW1lbnQuYm9keSkub2ZmKFwic3RpY2t5X2tpdDpyZWNhbGNcIiwgcmVjYWxjX2FuZF90aWNrKTtcclxuICAgICAgICBlbG0ub2ZmKFwic3RpY2t5X2tpdDpkZXRhY2hcIiwgZGV0YWNoKTtcclxuICAgICAgICBlbG0ucmVtb3ZlRGF0YShcInN0aWNreV9raXRcIik7XHJcbiAgICAgICAgZWxtLmNzcyh7XHJcbiAgICAgICAgICBwb3NpdGlvbjogXCJcIixcclxuICAgICAgICAgIGJvdHRvbTogXCJcIixcclxuICAgICAgICAgIHRvcDogXCJcIixcclxuICAgICAgICAgIHdpZHRoOiBcIlwiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcGFyZW50LnBvc2l0aW9uKFwicG9zaXRpb25cIiwgXCJcIik7XHJcbiAgICAgICAgaWYgKGZpeGVkKSB7XHJcbiAgICAgICAgICBpZiAobWFudWFsX3NwYWNlciA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChlbF9mbG9hdCA9PT0gXCJsZWZ0XCIgfHwgZWxfZmxvYXQgPT09IFwicmlnaHRcIikge1xyXG4gICAgICAgICAgICAgIGVsbS5pbnNlcnRBZnRlcihzcGFjZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNwYWNlci5yZW1vdmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBlbG0ucmVtb3ZlQ2xhc3Moc3RpY2t5X2NsYXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIHdpbi5vbihcInRvdWNobW92ZVwiLCB0aWNrKTtcclxuICAgICAgd2luLm9uKFwic2Nyb2xsXCIsIHRpY2spO1xyXG4gICAgICB3aW4ub24oXCJyZXNpemVcIiwgcmVjYWxjX2FuZF90aWNrKTtcclxuICAgICAgJChkb2N1bWVudC5ib2R5KS5vbihcInN0aWNreV9raXQ6cmVjYWxjXCIsIHJlY2FsY19hbmRfdGljayk7XHJcbiAgICAgIGVsbS5vbihcInN0aWNreV9raXQ6ZGV0YWNoXCIsIGRldGFjaCk7XHJcbiAgICAgIHJldHVybiBzZXRUaW1lb3V0KHRpY2ssIDApO1xyXG4gICAgfTtcclxuICAgIGZvciAoaSA9IDAsIGxlbiA9IHRoaXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgZWxtID0gdGhpc1tpXTtcclxuICAgICAgZm4oJChlbG0pKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH07XHJcblxyXG59KS5jYWxsKHRoaXMpOyJdfQ==
